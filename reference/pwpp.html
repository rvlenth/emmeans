<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Pairwise P-value plot — pwpp • emmeans</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pairwise P-value plot — pwpp"><meta name="description" content="Constructs a plot of P values associated with pairwise comparisons of
estimated marginal means."><meta property="og:description" content="Constructs a plot of P values associated with pairwise comparisons of
estimated marginal means."><meta property="og:image" content="https://rvlenth.github.io/emmeans/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">emmeans</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/AQuickStart.html">Quick start guide for **emmeans**</a></li>
    <li><a class="dropdown-item" href="../articles/basics.html">Basics of estimated marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/comparisons.html">Comparisons and contrasts in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/confidence-intervals.html">Confidence intervals and tests in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/FAQs.html">FAQs for emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/interactions.html">Interaction analysis in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/messy-data.html">Working with messy data</a></li>
    <li><a class="dropdown-item" href="../articles/models.html">Models supported by emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/predictions.html">Prediction in **emmeans**</a></li>
    <li><a class="dropdown-item" href="../articles/re-engineering-clds.html">Re-engineering CLDs</a></li>
    <li><a class="dropdown-item" href="../articles/sophisticated.html">Sophisticated models in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/transformations.html">Transformations and link functions in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/utilities.html">Utilities and options for emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-topics.html">Index of vignette topics</a></li>
    <li><a class="dropdown-item" href="../articles/xplanations.html">Explanations supplement</a></li>
    <li><a class="dropdown-item" href="../articles/xtending.html">For developers: Extending **emmeans**</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rvlenth/emmeans/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Pairwise P-value plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/rvlenth/emmeans/blob/master/R/pwpp.R" class="external-link"><code>R/pwpp.R</code></a></small>
      <div class="d-none name"><code>pwpp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Constructs a plot of P values associated with pairwise comparisons of
estimated marginal means.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pwpp</span><span class="op">(</span><span class="va">emm</span>, method <span class="op">=</span> <span class="st">"pairwise"</span>, <span class="va">by</span>, sort <span class="op">=</span> <span class="cn">TRUE</span>, values <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"."</span>, <span class="va">xlab</span>, <span class="va">ylab</span>, xsub <span class="op">=</span> <span class="st">""</span>, plim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, add.space <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">aes</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-emm">emm<a class="anchor" aria-label="anchor" href="#arg-emm"></a></dt>
<dd><p>An <code>emmGrid</code> object</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character or list. Passed to <code><a href="contrast.html">contrast</a></code>, and defines
the contrasts to be displayed. Any contrast method may be used,
provided that each contrast includes one coefficient of <code>1</code>,
one coefficient of <code>-1</code>, and the rest <code>0</code>. That is, calling
<code>contrast(object, method)</code> produces a set of comparisons, each with
one estimate minus another estimate.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>Character vector of variable(s) in the grid to condition on. These will
create different panels, one for each level or level-combination.
Grid factors not in <code>by</code> are the <em>primary</em> factors:
whose levels or level combinations are compared pairwise.</p></dd>


<dt id="arg-sort">sort<a class="anchor" aria-label="anchor" href="#arg-sort"></a></dt>
<dd><p>Logical value. If <code>TRUE</code>, levels of the factor combinations are
ordered by their marginal means. If <code>FALSE</code>, they appear in
order based on the existing ordering of the factor levels involved.
Note that the levels are ordered the same way in all panels, and in
many cases this implies that the means in any particular panel
will <em>not</em> be ordered even when <code>sort = TRUE</code>.</p></dd>


<dt id="arg-values">values<a class="anchor" aria-label="anchor" href="#arg-values"></a></dt>
<dd><p>Logical value. If <code>TRUE</code>, the values of the EMMs are included
in the plot. When there are several side-by-side panels due
to <code>by</code> variable(s), the labels showing values start
stealing a lot of space from the plotting area; in those cases,
it may be desirable to specify <code>FALSE</code> or use <code>rows</code>
so that some panels are vertically stacked.</p></dd>


<dt id="arg-rows">rows<a class="anchor" aria-label="anchor" href="#arg-rows"></a></dt>
<dd><p>Character vector of which <code>by</code> variable(s) are used to define
rows of the panel layout. Those variables in <code>by</code> not included in
<code>rows</code> define columns in the array of panels.
A <code>"."</code> indicates that only one row
is used, so all panels are stacked side-by-side.</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>Character label to use in place of the default for the P-value axis.</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>Character label to use in place of the default for the primary-factor axis.</p></dd>


<dt id="arg-xsub">xsub<a class="anchor" aria-label="anchor" href="#arg-xsub"></a></dt>
<dd><p>Character label used as caption at the lower right of the plot.</p></dd>


<dt id="arg-plim">plim<a class="anchor" aria-label="anchor" href="#arg-plim"></a></dt>
<dd><p>numeric vector of value(s) between 0 and 1. These are included
among the observed p values so that the range of tick marks includes at
least the range of <code>plim</code>. Choosing <code>plim = c(0,1)</code> will ensure
the widest possible range.</p></dd>


<dt id="arg-add-space">add.space<a class="anchor" aria-label="anchor" href="#arg-add-space"></a></dt>
<dd><p>Numeric value to adjust amount of space used for value labels. Positioning
of value labels is tricky, and depends on how many panels and the
physical size of the plotting region. This parameter allows the user to
adjust the position. Changing it by one unit should shift the position by
about one character width (right if positive, left if negative).
Note that this interacts with <code>aes$label</code> below.</p></dd>


<dt id="arg-aes">aes<a class="anchor" aria-label="anchor" href="#arg-aes"></a></dt>
<dd><p>optional named list of lists. Entries considered are <code>point</code>,
<code>segment</code>, and <code>label</code>, and contents are passed to the respective
<code>ggplot2::geom_xxx()</code> functions. These affect rendering of points,
line segments joining them, and value labels.
Defaults are <code>point = list(size = 2)</code>,
<code>segment = list()</code>, and <code>label = list(size = 2.5)</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code>contrast</code> and <code><a href="summary.emmGrid.html">summary.emmGrid</a></code>,
as well as to <code>geom_segment</code> and <code>geom_label</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Factor levels (or combinations thereof) are plotted on the vertical scale, and P values
are plotted on the horizontal scale. Each P value is plotted twice – at
vertical positions corresponding to the levels being compared – and connected by
a line segment. Thus, it is easy to visualize which P values are small and large,
and which levels are compared. In addition, factor levels are color-coded, and the points
and half-line segments appear in the color of the other level.
The P-value scale is nonlinear, so as to stretch-out smaller P values and
compress larger ones.
P values smaller than 0.0004 are altered and plotted in a way that makes
  them more distinguishable from one another.</p>
<p>If <code>xlab</code>, <code>ylab</code>, and <code>xsub</code> are not provided, reasonable labels
are created. <code>xsub</code> is used to note special features; e.g., equivalence
thresholds or one-sided tests.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If <code>emm</code> is the result of a Bayesian analysis, the plot is based on
  summaries with <code>frequentist = TRUE</code>.</p>
<p>The <span class="pkg">ggplot2</span> and <span class="pkg">scales</span> packages must be installed in order
  for <code>pwpp</code> to work.</p>
<p>Additional plot aesthetics are available by adding them to the returned object;
  see the examples</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>A numerical display of essentially the same results is available
  from <code><a href="pwpm.html">pwpm</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">pigs.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">conc</span><span class="op">)</span> <span class="op">~</span> <span class="va">source</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">percent</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">pigs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">emm</span> <span class="op">=</span> <span class="fu"><a href="emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">pigs.lm</span>, <span class="op">~</span> <span class="va">percent</span> <span class="op">|</span> <span class="va">source</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwpp</span><span class="op">(</span><span class="va">emm</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pwpp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">pwpp</span><span class="op">(</span><span class="va">emm</span>, method <span class="op">=</span> <span class="st">"trt.vs.ctrl1"</span>, type <span class="op">=</span> <span class="st">"response"</span>, side <span class="op">=</span> <span class="st">"&gt;"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: adjust = "dunnettx" was changed to "sidak"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> because "dunnettx" is not appropriate for one-sided inferences</span>
<span class="r-plt img"><img src="pwpp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># custom aesthetics:</span></span></span>
<span class="r-in"><span><span class="va">my.aes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>point <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"square"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>               segment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"serif"</span>, fontface <span class="op">=</span> <span class="st">"italic"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my.pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"blue"</span>, <span class="st">"magenta"</span>, <span class="st">"orange"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">pwpp</span><span class="op">(</span><span class="va">emm</span>, aes <span class="op">=</span> <span class="va">my.aes</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">my.pal</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pwpp-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell V. Lenth, Julia Piaskowski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

