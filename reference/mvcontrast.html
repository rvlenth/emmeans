<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Multivariate contrasts — mvcontrast • emmeans</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Multivariate contrasts — mvcontrast"><meta name="description" content="This function displays tests of multivariate comparisons or contrasts.
The contrasts are constructed at each level of the variable in mult.name,
and then we do a multivariate test that the vector of estimates is equal to
null (zero by default). The F statistic and degrees
of freedom are determined via the Hotelling distribution. that is, if there are
\(m\) error degrees of freedom and multivariate dimensionality \(d\), then
the resulting \(F\) statistic has degrees of freedom \((d, m - d + 1)\)
as shown in Hotelling (1931)."><meta property="og:description" content="This function displays tests of multivariate comparisons or contrasts.
The contrasts are constructed at each level of the variable in mult.name,
and then we do a multivariate test that the vector of estimates is equal to
null (zero by default). The F statistic and degrees
of freedom are determined via the Hotelling distribution. that is, if there are
\(m\) error degrees of freedom and multivariate dimensionality \(d\), then
the resulting \(F\) statistic has degrees of freedom \((d, m - d + 1)\)
as shown in Hotelling (1931)."><meta property="og:image" content="https://rvlenth.github.io/emmeans/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">emmeans</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.11.2-80001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/AQuickStart.html">Quick start guide for **emmeans**</a></li>
    <li><a class="dropdown-item" href="../articles/basics.html">Basics of estimated marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/comparisons.html">Comparisons and contrasts in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/confidence-intervals.html">Confidence intervals and tests in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/FAQs.html">FAQs for emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/interactions.html">Interaction analysis in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/messy-data.html">Working with messy data</a></li>
    <li><a class="dropdown-item" href="../articles/models.html">Models supported by emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/predictions.html">Prediction in **emmeans**</a></li>
    <li><a class="dropdown-item" href="../articles/re-engineering-clds.html">Re-engineering CLDs</a></li>
    <li><a class="dropdown-item" href="../articles/sophisticated.html">Sophisticated models in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/transformations.html">Transformations and link functions in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/utilities.html">Utilities and options for emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-topics.html">Index of vignette topics</a></li>
    <li><a class="dropdown-item" href="../articles/xplanations.html">Explanations supplement</a></li>
    <li><a class="dropdown-item" href="../articles/xtending.html">For developers: Extending **emmeans**</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rvlenth/emmeans/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Multivariate contrasts</h1>
      <small class="dont-index">Source: <a href="https://github.com/rvlenth/emmeans/blob/master/R/multiv.R" class="external-link"><code>R/multiv.R</code></a></small>
      <div class="d-none name"><code>mvcontrast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function displays tests of multivariate comparisons or contrasts.
The contrasts are constructed at each level of the variable in <code>mult.name</code>,
and then we do a multivariate test that the vector of estimates is equal to
<code>null</code> (zero by default). The <em>F</em> statistic and degrees
of freedom are determined via the Hotelling distribution. that is, if there are
\(m\) error degrees of freedom and multivariate dimensionality \(d\), then
the resulting \(F\) statistic has degrees of freedom \((d, m - d + 1)\)
as shown in Hotelling (1931).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mvcontrast</span><span class="op">(</span><span class="va">object</span>, method <span class="op">=</span> <span class="st">"eff"</span>, mult.name <span class="op">=</span> <span class="va">object</span><span class="op">@</span><span class="va">roles</span><span class="op">$</span><span class="va">multresp</span>,</span>
<span>  null <span class="op">=</span> <span class="fl">0</span>, by <span class="op">=</span> <span class="va">object</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">by.vars</span>, adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sidak"</span>,</span>
<span>  <span class="va">p.adjust.methods</span><span class="op">)</span>, show.ests <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class <code>emmGrid</code></p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>A contrast method, per <code><a href="contrast.html">contrast.emmGrid</a></code></p></dd>


<dt id="arg-mult-name">mult.name<a class="anchor" aria-label="anchor" href="#arg-mult-name"></a></dt>
<dd><p>Character vector of names of the factors whose levels
define the multivariate means to contrast. If the model itself has a
multivariate response, that is what is used. Otherwise, <code>mult.name</code>
<em>must</em> be specified.</p></dd>


<dt id="arg-null">null<a class="anchor" aria-label="anchor" href="#arg-null"></a></dt>
<dd><p>Scalar or conformable vector of null-hypothesis values to test against</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>Any <code>by</code> variable(s). These should not include the primary
variables to be contrasted. For convenience, the <code>by</code> variable is
nulled-out if it would result in no primary factors being contrasted.</p></dd>


<dt id="arg-adjust">adjust<a class="anchor" aria-label="anchor" href="#arg-adjust"></a></dt>
<dd><p>Character value of a multiplicity adjustment method
(<code>"none"</code> for no adjustment). The available adjustment methods are
more limited that in <code>contrast</code>, and any default adjustment returned
via <code>method</code> is ignored.</p></dd>


<dt id="arg-show-ests">show.ests<a class="anchor" aria-label="anchor" href="#arg-show-ests"></a></dt>
<dd><p>Logical flag determining whether the multivariate means
are displayed</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code>contrast</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>summary_emm</code> containing the multivariate
  test results; or a list of the estimates and the tests if <code>show.ests</code>
  is <code>TRUE</code>. The test results include the Hotelling \(T^2\) statistic,
  \(F\) ratios, degrees of freedom, and \(P\) values.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>If some interactions among the primary and <code>mult.name</code> factors are
absent, the covariance of the multivariate means is singular; this situation
is accommodated, but the result has reduced degrees of freedom and a message
is displayed. If there are other abnormal conditions such as non-estimable
results, estimates are shown as <code>NA</code>.</p>
<p>While designed primarily for testing contrasts, multivariate tests of the
mean vector itself can be implemented via <code>method = "identity")</code> (see
the examples).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Hotelling, Harold (1931) "The generalization of Student's ratio",
  <em>Annals of Mathematical Statistics</em> 2(3), 360–378. doi:10.1214/aoms/1177732979</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">MOats.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">Variety</span> <span class="op">+</span> <span class="va">Block</span>, data <span class="op">=</span> <span class="va">MOats</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MOats.emm</span> <span class="op">&lt;-</span> <span class="fu"><a href="emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">MOats.lm</span>, <span class="op">~</span> <span class="va">Variety</span> <span class="op">|</span> <span class="va">rep.meas</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">mvcontrast</span><span class="op">(</span><span class="va">MOats.emm</span>, <span class="st">"consec"</span>, show.ests <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># mult.name defaults to rep.meas</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $estimates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> contrast = Marvellous - Golden Rain:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas    estimate    SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas0       6.67  7.84 10   0.851  0.4148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas0.2    10.00  9.34 10   1.071  0.3093</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas0.4     2.50 12.30 10   0.203  0.8430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas0.6     2.00 10.30 10   0.194  0.8503</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> contrast = Victory - Marvellous:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas    estimate    SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas0     -15.17  7.84 10  -1.936  0.0817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas0.2   -18.83  9.34 10  -2.017  0.0713</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas0.4    -6.33 12.30 10  -0.515  0.6177</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas0.6    -8.33 10.30 10  -0.807  0.4385</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Results are averaged over the levels of: Block </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tests</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast                 T.square df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Marvellous - Golden Rain    3.082   4   7   0.539  0.9174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Victory - Marvellous        9.181   4   7   1.607  0.4726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P value adjustment: sidak </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test each mean against a specified null vector</span></span></span>
<span class="r-in"><span><span class="fu">mvcontrast</span><span class="op">(</span><span class="va">MOats.emm</span>, <span class="st">"identity"</span>, name <span class="op">=</span> <span class="st">"Variety"</span>, </span></span>
<span class="r-in"><span>           null <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">80</span>, <span class="fl">100</span>, <span class="fl">120</span>, <span class="fl">140</span><span class="op">)</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Variety     T.square df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Golden Rain   10.001   4   7   1.750  0.2430</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Marvellous    26.628   4   7   4.660  0.0377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Victory       10.232   4   7   1.791  0.2352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># (Note 'name' is passed to contrast() and overrides default name "contrast")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 'mult.name' need not refer to a multivariate response</span></span></span>
<span class="r-in"><span><span class="fu">mvcontrast</span><span class="op">(</span><span class="va">MOats.emm</span>, <span class="st">"trt.vs.ctrl1"</span>, mult.name <span class="op">=</span> <span class="st">"Variety"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast                T.square df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas0.2 - rep.meas0   21.498   3   8   5.733  0.0634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas0.4 - rep.meas0   37.578   3   8  10.021  0.0131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  rep.meas0.6 - rep.meas0  104.700   3   8  27.920  0.0004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P value adjustment: sidak </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell V. Lenth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

