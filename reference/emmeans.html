<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Compute estimated marginal means (EMMs) for specified factors
or factor combinations in a linear model; and optionally, comparisons or
contrasts among them. EMMs are also known as least-squares means."><title>Estimated marginal means (Least-squares means) — emmeans • emmeans</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimated marginal means (Least-squares means) — emmeans"><meta property="og:description" content="Compute estimated marginal means (EMMs) for specified factors
or factor combinations in a linear model; and optionally, comparisons or
contrasts among them. EMMs are also known as least-squares means."><meta property="og:image" content="https://rvlenth.github.io/emmeans/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">emmeans</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.10.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/AQuickStart.html">Quick start guide for **emmeans**</a>
    <a class="dropdown-item" href="../articles/basics.html">Basics of estimated marginal means</a>
    <a class="dropdown-item" href="../articles/comparisons.html">Comparisons and contrasts in emmeans</a>
    <a class="dropdown-item" href="../articles/confidence-intervals.html">Confidence intervals and tests in emmeans</a>
    <a class="dropdown-item" href="../articles/FAQs.html">FAQs for emmeans</a>
    <a class="dropdown-item" href="../articles/interactions.html">Interaction analysis in emmeans</a>
    <a class="dropdown-item" href="../articles/messy-data.html">Working with messy data</a>
    <a class="dropdown-item" href="../articles/models.html">Models supported by emmeans</a>
    <a class="dropdown-item" href="../articles/predictions.html">Prediction in **emmeans**</a>
    <a class="dropdown-item" href="../articles/re-engineering-clds.html">Re-engineering CLDs</a>
    <a class="dropdown-item" href="../articles/sophisticated.html">Sophisticated models in emmeans</a>
    <a class="dropdown-item" href="../articles/transformations.html">Transformations and link functions in emmeans</a>
    <a class="dropdown-item" href="../articles/utilities.html">Utilities and options for emmeans</a>
    <a class="dropdown-item" href="../articles/vignette-topics.html">Index of vignette topics</a>
    <a class="dropdown-item" href="../articles/xplanations.html">Explanations supplement</a>
    <a class="dropdown-item" href="../articles/xtending.html">For developers: Extending **emmeans**</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rvlenth/emmeans/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimated marginal means (Least-squares means)</h1>
      <small class="dont-index">Source: <a href="https://github.com/rvlenth/emmeans/blob/HEAD/R/emmeans.R" class="external-link"><code>R/emmeans.R</code></a></small>
      <div class="d-none name"><code>emmeans.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute estimated marginal means (EMMs) for specified factors
or factor combinations in a linear model; and optionally, comparisons or
contrasts among them. EMMs are also known as least-squares means.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">emmeans</span><span class="op">(</span><span class="va">object</span>, <span class="va">specs</span>, by <span class="op">=</span> <span class="cn">NULL</span>, fac.reduce <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">coefs</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">coefs</span>,</span>
<span>  <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span>, <span class="va">contr</span>, options <span class="op">=</span> <span class="fu"><a href="emm_options.html">get_emm_option</a></span><span class="op">(</span><span class="st">"emmeans"</span><span class="op">)</span>, <span class="va">weights</span>, <span class="va">offset</span>, <span class="va">...</span>,</span>
<span>  <span class="va">tran</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>An object of class <code>emmGrid</code>; or a fitted model object
that is supported, such as the result of a call to <code>lm</code> or
<code>lmer</code>. Many fitted-model objects are supported; see
<a href="../doc/models.html"><code><a href="../articles/models.html">vignette("models", "emmeans")</a></code></a> for details.</p></dd>


<dt>specs</dt>
<dd><p>A <code>character</code> vector specifying the names of the predictors
over which EMMs are desired. <code>specs</code> may also be a <code>formula</code>
or a <code>list</code> (optionally named) of valid <code>spec</code>s. Use of formulas
is described in the Overview section below. 
<b>Note:</b> We recommend <em>against</em> using two-sided formulas; see the
note below for <code>contr</code>.</p></dd>


<dt>by</dt>
<dd><p>A character vector specifying the names of predictors to condition on.</p></dd>


<dt>fac.reduce</dt>
<dd><p>A function that combines the rows of a matrix into a single
vector. This implements the ``marginal averaging'' aspect of EMMs. 
The default is the mean of the rows. Typically if it is overridden,
it would be some kind of weighted mean of the rows. If <code>fac.reduce</code> is
nonlinear, bizarre results are likely, and EMMs will not be
interpretable. NOTE: If the <code>weights</code> argument is non-missing,
<code>fac.reduce</code> is ignored.</p></dd>


<dt>contr</dt>
<dd><p>A character value or <code>list</code> specifying contrasts to be
added. See <code><a href="contrast.html">contrast</a></code>. <b>Note:</b> <code>contr</code> is ignored when
<code>specs</code> is a formula. <b>Note 2:</b>: We recommend <em>against</em> using this
argument; obtaining means and obtaining contrasts are two different things,
and it is best to do them in separate steps, using the <code><a href="contrast.html">contrast</a></code>
function for the contrasts.</p></dd>


<dt>options</dt>
<dd><p>If non-<code>NULL</code>, a named <code>list</code> of arguments to pass
to <code><a href="update.emmGrid.html">update.emmGrid</a></code>, just after the object is constructed.
(Options may also be included in <code>...</code>; see the ‘options’
section below.)</p></dd>


<dt>weights</dt>
<dd><p>Character value, numeric vector, or numeric matrix specifying
weights to use in averaging predictions. See “Weights” section below.
Also, if <code>object</code> is not already a reference grid, <code>weights</code>
(if it is character) is passed to <code>ref_grid</code> as <code>wt.nuis</code> in case 
nuisance factors are specified. We can override this by specifying 
<code>wt.nuis</code> explicitly.
This more-or-less makes the weighting of nuisance factors consistent with
that of primary factors.</p></dd>


<dt>offset</dt>
<dd><p>Numeric vector or scalar. If specified, this adds an offset to
the predictions, or overrides any offset in the model or its
reference grid. If a vector of length differing from the number of rows in 
the result, it is subsetted or cyclically recycled.</p></dd>


<dt>...</dt>
<dd><p>When <code>object</code> is not already a <code>"emmGrid"</code>
object, these arguments are passed to <code><a href="ref_grid.html">ref_grid</a></code>. Common
examples are <code>at</code>, <code>cov.reduce</code>, <code>data</code>, <code>type</code>, 
<code>regrid</code>, <code>df</code>, <code>nesting</code>, and <code>vcov.</code>.
Model-type-specific options (see
<a href="../doc/models.html"><code><a href="../articles/models.html">vignette("models", "emmeans")</a></code></a>), commonly
<code>mode</code>, may be used here as well. In addition, if the model formula
contains references to variables that are not predictors, you must provide
a <code>params</code> argument with a list of their names.
These arguments may also be used in lieu of <code>options</code>. See the 
‘Options’ section below.</p></dd>


<dt>tran</dt>
<dd><p>Placeholder to prevent it from being included in <code>...</code>.
If non-missing, it is added to `options`. See the ‘Options’
section.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>When <code>specs</code> is a <code>character</code> vector or one-sided formula,
  an object of class <code>"emmGrid"</code>. A number of methods
  are provided for further analysis, including</p>
<p></p>
<p><code><a href="summary.emmGrid.html">summary.emmGrid</a></code>, <code><a href="summary.emmGrid.html">confint.emmGrid</a></code>,</p>
<p></p>
<p><code><a href="summary.emmGrid.html">test.emmGrid</a></code>, <code><a href="contrast.html">contrast.emmGrid</a></code>,
  and <code><a href="contrast.html">pairs.emmGrid</a></code>.
When <code>specs</code> is a <code>list</code> or a <code>formula</code> having a left-hand
side, the return value is an <code><a href="emm_list-object.html">emm_list</a></code> object, which is simply a
<code>list</code> of <code>emmGrid</code> objects.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Users should also consult the documentation for <code><a href="ref_grid.html">ref_grid</a></code>, 
because many important options for EMMs are implemented there, via the 
<code>...</code> argument.</p>
    </div>
    <div class="section level2">
    <h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h2>
    

<p>Estimated marginal means or EMMs (sometimes called least-squares means) are
predictions from a linear model over a <em>reference grid</em>; or marginal
averages thereof. The <code><a href="ref_grid.html">ref_grid</a></code> function identifies/creates the
reference grid upon which <code>emmeans</code> is based.</p>
<p>For those who prefer the terms “least-squares means” or
“predicted marginal means”, functions <code>lsmeans</code> and
<code>pmmeans</code> are provided as wrappers. See <code><a href="wrappers.html">wrappers</a></code>.</p>
<p>If <code>specs</code> is a <code>formula</code>, it should be of the form <code>~ specs</code>,
<code>~ specs | by</code>, <code>contr ~ specs</code>, or <code>contr ~ specs | by</code>. The
formula is parsed and the variables therein are used as the arguments
<code>specs</code>, <code>by</code>, and <code>contr</code> as indicated. The left-hand side is
optional (and we don't recommend it), but if specified it should be the 
name of a contrast family (e.g., <code>pairwise</code>). Operators like
<code>*</code> or <code>:</code> are needed in the formula to delineate names, but
otherwise are ignored.</p>
<p>In the special case where the mean (or weighted mean) of all the predictions
is desired, specify <code>specs</code> as <code>~ 1</code> or <code>"1"</code>.</p>
<p>A number of standard contrast families are provided. They can be identified 
as functions having names ending in <code>.emmc</code> -- see the documentation
for <code><a href="emmc-functions.html">emmc-functions</a></code> for details -- including how to write your
own <code>.emmc</code> function for custom contrasts.</p>
    </div>
    <div class="section level2">
    <h2 id="weights">Weights<a class="anchor" aria-label="anchor" href="#weights"></a></h2>
    

<p>If <code>weights</code> is a vector, its length must equal
  the number of predictions to be averaged to obtain each EMM.
  If a matrix, each row of the matrix is used in turn, wrapping back to the
  first row as needed.  When in doubt about what is being averaged (or how
  many), first call <code>emmeans</code> with <code>weights = "show.levels"</code>.</p>  
<p>If <code>weights</code> is a string, it should partially match one of the following:</p><dl><dt><code>"equal"</code></dt>
<dd><p>Use an equally weighted average.</p></dd>

<dt><code>"proportional"</code></dt>
<dd><p>Weight in proportion to the frequencies (in the
  original data) of the factor combinations that are averaged over.</p></dd>

<dt><code>"outer"</code></dt>
<dd><p>Weight in proportion to each individual factor's
  marginal frequencies. Thus, the weights for a combination of factors are the
  outer product of the one-factor margins</p></dd>

<dt><code>"cells"</code></dt>
<dd><p>Weight according to the frequencies of the cells being
  averaged.</p></dd>

<dt><code>"flat"</code></dt>
<dd><p>Give equal weight to all cells with data, and ignore
  empty cells.</p></dd>

<dt><code>"show.levels"</code></dt>
<dd><p>This is a convenience feature for understanding
  what is being averaged over. Instead of a table of EMMs, this causes the
  function to return a table showing the levels that are averaged over, in the
  order that they appear.</p></dd>


</dl><p>Outer weights are like the 'expected' counts in a chi-square test of
independence, and will yield the same results as those obtained by
proportional averaging with one factor at a time. All except <code>"cells"</code>
uses the same set of weights for each mean. In a model where the predicted
values are the cell means, cell weights will yield the raw averages of the
data for the factors involved. Using <code>"flat"</code> is similar to
<code>"cells"</code>, except nonempty cells are weighted equally and empty cells
are ignored.</p>
    </div>
    <div class="section level2">
    <h2 id="offsets">Offsets<a class="anchor" aria-label="anchor" href="#offsets"></a></h2>
    

<p>Unlike in <code>ref_grid</code>, an offset need not be scalar. If not enough values
are supplied, they are cyclically recycled. For a vector of offsets, it is 
important to understand that the ordering of results goes with the first 
name in <code>specs</code> varying fastest. If there are any <code>by</code> factors,
those vary slower than all the primary ones, but the first <code>by</code> variable
varies the fastest within that hierarchy. See the examples.</p>
    </div>
    <div class="section level2">
    <h2 id="options-and-">Options and <code>...</code><a class="anchor" aria-label="anchor" href="#options-and-"></a></h2>
    

<p>Arguments that could go in <code>options</code> may instead be included in <code>...</code>,
  typically, arguments such as <code>type</code>, <code>infer</code>, etc. that in essence
  are passed to <code><a href="summary.emmGrid.html">summary.emmGrid</a></code>. Arguments in both places are 
  overridden by the ones in <code>...</code>.</p>  
<p>There is a danger that <code>...</code> arguments could partially match those used
  by both <code>ref_grid</code> and <code>update.emmGrid</code>, creating a conflict.
  If these occur, usually they can be resolved by providing complete (or at least 
  longer) argument names; or by isolating non-<code>ref_grid</code> arguments in
  <code>options</code>; or by calling <code>ref_grid</code> separately and passing the
  result as <code>object</code>. See a not-run example below.</p>  
<p>Also, when <code>specs</code> is a two-sided formula, or <code>contr</code> is specified,
  there is potential confusion concerning which <code>...</code> arguments
  apply to the means, and which to the contrasts. When such confusion is possible,
  we suggest doing things separately 
  (a call to <code>emmeans</code> with no contrasts, followed by a call to 
  <code><a href="contrast.html">contrast</a></code>). We treat
  <code>adjust</code> as a special case: it is applied to the <code>emmeans</code> results 
  <em>only</em> if there are
  no contrasts specified, otherwise it is passed only to <code>contrast</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ref_grid.html">ref_grid</a></code>, <code><a href="contrast.html">contrast</a></code>, 
<a href="../doc/models.html">vignette("models", "emmeans")</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">warp.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">breaks</span> <span class="op">~</span> <span class="va">wool</span> <span class="op">*</span> <span class="va">tension</span>, data <span class="op">=</span> <span class="va">warpbreaks</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">emmeans</span> <span class="op">(</span><span class="va">warp.lm</span>,  <span class="op">~</span> <span class="va">wool</span> <span class="op">|</span> <span class="va">tension</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tension = L:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  wool emmean   SE df lower.CL upper.CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A      44.6 3.65 48     37.2     51.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  B      28.2 3.65 48     20.9     35.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tension = M:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  wool emmean   SE df lower.CL upper.CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A      24.0 3.65 48     16.7     31.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  B      28.8 3.65 48     21.4     36.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tension = H:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  wool emmean   SE df lower.CL upper.CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A      24.6 3.65 48     17.2     31.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  B      18.8 3.65 48     11.4     26.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence level used: 0.95 </span>
<span class="r-in"><span><span class="co"># or equivalently emmeans(warp.lm, "wool", by = "tension")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 'adjust' argument ignored in emmeans, passed to contrast part...</span></span></span>
<span class="r-in"><span><span class="fu">emmeans</span> <span class="op">(</span><span class="va">warp.lm</span>, <span class="va">poly</span> <span class="op">~</span> <span class="va">tension</span> <span class="op">|</span> <span class="va">wool</span>, adjust <span class="op">=</span> <span class="st">"sidak"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $emmeans</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = A:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  tension emmean   SE df lower.CL upper.CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L         44.6 3.65 48     37.2     51.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  M         24.0 3.65 48     16.7     31.3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H         24.6 3.65 48     17.2     31.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = B:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  tension emmean   SE df lower.CL upper.CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L         28.2 3.65 48     20.9     35.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  M         28.8 3.65 48     21.4     36.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H         18.8 3.65 48     11.4     26.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence level used: 0.95 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $contrasts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = A:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast  estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  linear      -20.00 5.16 48  -3.878  0.0006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  quadratic    21.11 8.93 48   2.363  0.0439</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = B:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast  estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  linear       -9.44 5.16 48  -1.831  0.1412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  quadratic   -10.56 8.93 48  -1.182  0.4272</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P value adjustment: sidak method for 2 tests </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 'adjust' argument NOT ignored ...</span></span></span>
<span class="r-in"><span><span class="fu">emmeans</span> <span class="op">(</span><span class="va">warp.lm</span>, <span class="op">~</span> <span class="va">tension</span> <span class="op">|</span> <span class="va">wool</span>, adjust <span class="op">=</span> <span class="st">"sidak"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = A:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  tension emmean   SE df lower.CL upper.CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L         44.6 3.65 48    35.53     53.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  M         24.0 3.65 48    14.98     33.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H         24.6 3.65 48    15.53     33.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = B:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  tension emmean   SE df lower.CL upper.CL</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L         28.2 3.65 48    19.20     37.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  M         28.8 3.65 48    19.76     37.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H         18.8 3.65 48     9.76     27.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence level used: 0.95 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Conf-level adjustment: sidak method for 3 estimates </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co">### Offsets: Consider a silly example:</span></span></span>
<span class="r-in"><span>  <span class="fu">emmeans</span><span class="op">(</span><span class="va">warp.lm</span>, <span class="op">~</span> <span class="va">tension</span> <span class="op">|</span> <span class="va">wool</span>, offset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17</span>, <span class="fl">23</span>, <span class="fl">47</span><span class="op">)</span><span class="op">)</span> <span class="op">@</span> <span class="va">grid</span></span></span>
<span class="r-in"><span>  <span class="co"># note that offsets are recycled so that each level of tension receives</span></span></span>
<span class="r-in"><span>  <span class="co"># the same offset for each wool.</span></span></span>
<span class="r-in"><span>  <span class="co"># But using the same offsets with ~ wool | tension will probably not</span></span></span>
<span class="r-in"><span>  <span class="co"># be what you want because the ordering of combinations is different.</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell V. Lenth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

