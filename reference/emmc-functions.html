<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Contrast families — contrast-methods • emmeans</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Contrast families — contrast-methods"><meta name="description" content="Functions with an extension of .emmc provide for named contrast
families. One of the standard ones documented here may be used, or the user
may write such a function."><meta property="og:description" content="Functions with an extension of .emmc provide for named contrast
families. One of the standard ones documented here may be used, or the user
may write such a function."><meta property="og:image" content="https://rvlenth.github.io/emmeans/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">emmeans</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.10.4.900001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/AQuickStart.html">Quick start guide for **emmeans**</a></li>
    <li><a class="dropdown-item" href="../articles/basics.html">Basics of estimated marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/comparisons.html">Comparisons and contrasts in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/confidence-intervals.html">Confidence intervals and tests in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/FAQs.html">FAQs for emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/interactions.html">Interaction analysis in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/messy-data.html">Working with messy data</a></li>
    <li><a class="dropdown-item" href="../articles/models.html">Models supported by emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/predictions.html">Prediction in **emmeans**</a></li>
    <li><a class="dropdown-item" href="../articles/re-engineering-clds.html">Re-engineering CLDs</a></li>
    <li><a class="dropdown-item" href="../articles/sophisticated.html">Sophisticated models in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/transformations.html">Transformations and link functions in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/utilities.html">Utilities and options for emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-topics.html">Index of vignette topics</a></li>
    <li><a class="dropdown-item" href="../articles/xplanations.html">Explanations supplement</a></li>
    <li><a class="dropdown-item" href="../articles/xtending.html">For developers: Extending **emmeans**</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rvlenth/emmeans/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Contrast families</h1>
      <small class="dont-index">Source: <a href="https://github.com/rvlenth/emmeans/blob/master/R/emm-contr.R" class="external-link"><code>R/emm-contr.R</code></a></small>
      <div class="d-none name"><code>emmc-functions.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Functions with an extension of <code>.emmc</code> provide for named contrast
families. One of the standard ones documented here may be used, or the user
may write such a function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pairwise.emmc</span><span class="op">(</span><span class="va">levs</span>, exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="va">include</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">revpairwise.emmc</span><span class="op">(</span><span class="va">levs</span>, exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="va">include</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tukey.emmc</span><span class="op">(</span><span class="va">levs</span>, reverse <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">poly.emmc</span><span class="op">(</span><span class="va">levs</span>, max.degree <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fl">6</span>, <span class="va">k</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trt.vs.ctrl.emmc</span><span class="op">(</span><span class="va">levs</span>, ref <span class="op">=</span> <span class="fl">1</span>, reverse <span class="op">=</span> <span class="cn">FALSE</span>, exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="va">include</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trt.vs.ctrl1.emmc</span><span class="op">(</span><span class="va">levs</span>, ref <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">trt.vs.ctrlk.emmc</span><span class="op">(</span><span class="va">levs</span>, ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">levs</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">dunnett.emmc</span><span class="op">(</span><span class="va">levs</span>, ref <span class="op">=</span> <span class="fl">1</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">eff.emmc</span><span class="op">(</span><span class="va">levs</span>, exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="va">include</span>, wts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">levs</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">del.eff.emmc</span><span class="op">(</span><span class="va">levs</span>, exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="va">include</span>, wts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">levs</span><span class="op">)</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">consec.emmc</span><span class="op">(</span><span class="va">levs</span>, reverse <span class="op">=</span> <span class="cn">FALSE</span>, exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="va">include</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">mean_chg.emmc</span><span class="op">(</span><span class="va">levs</span>, reverse <span class="op">=</span> <span class="cn">FALSE</span>, exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="va">include</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wtcon.emmc</span><span class="op">(</span><span class="va">levs</span>, <span class="va">wts</span>, cmtype <span class="op">=</span> <span class="st">"GrandMean"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">identity.emmc</span><span class="op">(</span><span class="va">levs</span>, exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>, <span class="va">include</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-levs">levs<a class="anchor" aria-label="anchor" href="#arg-levs"></a></dt>
<dd><p>Vector of factor levels</p></dd>


<dt id="arg-exclude">exclude<a class="anchor" aria-label="anchor" href="#arg-exclude"></a></dt>
<dd><p>integer vector of indices, or character vector of levels to
exclude from consideration. These levels will receive weight 0 in all
contrasts. Character levels must exactly match elements of <code>levs</code>.</p></dd>


<dt id="arg-include">include<a class="anchor" aria-label="anchor" href="#arg-include"></a></dt>
<dd><p>integer or character vector of levels to include (the
complement of <code>exclude</code>). An error will result if the user specifies
both <code>exclude</code> and <code>include</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments, passed to related methods as appropriate</p></dd>


<dt id="arg-reverse">reverse<a class="anchor" aria-label="anchor" href="#arg-reverse"></a></dt>
<dd><p>Logical value to determine the direction of comparisons</p></dd>


<dt id="arg-max-degree">max.degree<a class="anchor" aria-label="anchor" href="#arg-max-degree"></a></dt>
<dd><p>Integer specifying the maximum degree of polynomial contrasts</p></dd>


<dt id="arg-ref">ref<a class="anchor" aria-label="anchor" href="#arg-ref"></a></dt>
<dd><p>Integer(s) or character(s) specifying which level(s) to use
as the reference. Character values must exactly match elements of <code>levs</code>
(including any enhancements – see examples)</p></dd>


<dt id="arg-wts">wts<a class="anchor" aria-label="anchor" href="#arg-wts"></a></dt>
<dd><p>Optional weights to use with <code>eff.emmc</code> and <code>del.eff.emmc</code> contrasts.
These default to equal weights.
If <code>exclude</code> or <code>include</code> are specified, <code>wts</code> may be
either the same length as <code>levs</code> or the length of the included levels.
In the former case, weights for any excluded levels are set to zero.
<code>wts</code> has no impact on the results unless there are at least
three levels included in the contrast.</p></dd>


<dt id="arg-cmtype">cmtype<a class="anchor" aria-label="anchor" href="#arg-cmtype"></a></dt>
<dd><p>the <code>type</code> argument passed to <code><a href="https://rdrr.io/pkg/multcomp/man/contrMat.html" class="external-link">contrMat</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame, each column containing contrast coefficients for levs.
  The "desc" attribute is used to label the results in emmeans, and the
  "adjust" attribute gives the default adjustment method for multiplicity.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Each standard contrast family has a default multiple-testing adjustment as
noted below. These adjustments are often only approximate; for a more
exacting adjustment, use the interfaces provided to <code>glht</code> in the
<span class="pkg">multcomp</span> package.</p>
<p><code>pairwise.emmc</code>, <code>revpairwise.emmc</code>, and <code>tukey.emmc</code> generate
contrasts for all pairwise comparisons among estimated marginal means at the
levels in levs. The distinction is in which direction they are subtracted.
For factor levels A, B, C, D, <code>pairwise.emmc</code> generates the comparisons
A-B, A-C, A-D, B-C, B-D, and C-D, whereas <code>revpairwise.emmc</code> generates
B-A, C-A, C-B, D-A, D-B, and D-C. <code>tukey.emmc</code> invokes
<code>pairwise.emmc</code> or <code>revpairwise.emmc</code> depending on <code>reverse</code>.
The default multiplicity adjustment method is <code>"tukey"</code>, which is only
approximate when the standard errors differ.</p>
<p><code>poly.emmc</code> generates orthogonal polynomial contrasts, assuming
equally-spaced factor levels. These are derived from the
<code><a href="https://rdrr.io/r/stats/poly.html" class="external-link">poly</a></code> function, but an <em>ad hoc</em> algorithm is used to
scale them to integer coefficients that are (usually) the same as in
published tables of orthogonal polynomial contrasts. The default multiplicity
adjustment method is <code>"none"</code>.</p>
<p><code>trt.vs.ctrl.emmc</code> and its relatives generate contrasts for comparing
one level (or the average over specified levels) with each of the other
levels. The argument <code>ref</code> should be the index(es) (not the labels) of
the reference level(s). <code>trt.vs.ctrl1.emmc</code> is the same as
<code>trt.vs.ctrl.emmc</code> with a reference value of 1, and
<code>trt.vs.ctrlk.emmc</code> is the same as <code>trt.vs.ctrl</code> with a reference
value of <code>length(levs)</code>. <code>dunnett.emmc</code> is the same as
<code>trt.vs.ctrl</code>. The default multiplicity adjustment method is
<code>"dunnettx"</code>, a close approximation to the Dunnett adjustment.
<em>Note</em> in all of these functions, it is illegal to have any overlap
between the <code>ref</code> levels and the <code>exclude</code> levels. If any is found,
an error is thrown.</p>
<p><code>consec.emmc</code> and <code>mean_chg.emmc</code> are useful for contrasting
treatments that occur in sequence. For a factor with levels A, B, C, D, E,
<code>consec.emmc</code> generates the comparisons B-A, C-B, and D-C, while
<code>mean_chg.emmc</code> generates the contrasts (B+C+D)/3 - A, (C+D)/2 -
(A+B)/2, and D - (A+B+C)/3. With <code>reverse = TRUE</code>, these differences go
in the opposite direction.</p>
<p><code>eff.emmc</code> and <code>del.eff.emmc</code> generate contrasts that compare each
level with the average over all levels (in <code>eff.emmc</code>) or over all other
levels (in <code>del.eff.emmc</code>). These differ only in how they are scaled.
For a set of k EMMs, <code>del.eff.emmc</code> gives weight 1 to one EMM and weight
-1/(k-1) to the others, while <code>eff.emmc</code> gives weights (k-1)/k and -1/k
respectively, as in subtracting the overall EMM from each EMM. The default
multiplicity adjustment method is <code>"fdr"</code>. This is a Bonferroni-based
method and is slightly conservative; see <code><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></code>.</p>
<p><code>wtcon.emmc</code> generates weighted contrasts based on the function
<code><a href="https://rdrr.io/pkg/multcomp/man/contrMat.html" class="external-link">contrMat</a></code> function in the <span class="pkg">multcomp</span> package,
using the provided <code>type</code> as documented there. If the user provides
<code>wts</code>, they have to conform to the length of <code>levs</code>; however,
if <code>wts</code> is not specified, <code>contrast</code> will fill-in what is
required, and usually this is safer (especially when <code>by != NULL</code>
which usually means that the weights are different in each <code>by</code> group).</p>
<p><code>identity.emmc</code> simply returns the identity matrix (as a data frame),
minus any columns specified in <code>exclude</code>. It is potentially useful in
cases where a contrast function must be specified, but none is desired.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>Caution is needed in cases where the user alters the ordering of
  results (e.g., using the the <code>"[...]"</code> operator), because the
  contrasts generated depend on the order of the levels provided. For
  example, suppose <code>trt.vs.ctrl1</code> contrasts are applied to two <code>by</code>
  groups with levels ordered (Ctrl, T1, T2) and (T1, T2, Ctrl) respectively,
  then the contrasts generated will be for (T1 - Ctrl, T2 - Ctrl) in the
  first group and (T2 - T1, Ctrl - T1) in the second group, because the first
  level in each group is used as the reference level.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">warp.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">breaks</span> <span class="op">~</span> <span class="va">wool</span><span class="op">*</span><span class="va">tension</span>, data <span class="op">=</span> <span class="va">warpbreaks</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">warp.emm</span> <span class="op">&lt;-</span> <span class="fu"><a href="emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">warp.lm</span>, <span class="op">~</span> <span class="va">tension</span> <span class="op">|</span> <span class="va">wool</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="contrast.html">contrast</a></span><span class="op">(</span><span class="va">warp.emm</span>, <span class="st">"poly"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = A:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast  estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  linear      -20.00 5.16 48  -3.878  0.0003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  quadratic    21.11 8.93 48   2.363  0.0222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = B:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast  estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  linear       -9.44 5.16 48  -1.831  0.0733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  quadratic   -10.56 8.93 48  -1.182  0.2432</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="contrast.html">contrast</a></span><span class="op">(</span><span class="va">warp.emm</span>, <span class="st">"trt.vs.ctrl"</span>, ref <span class="op">=</span> <span class="st">"M"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = A:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L - M      20.556 5.16 48   3.986  0.0005</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H - M       0.556 5.16 48   0.108  0.9863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = B:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L - M      -0.556 5.16 48  -0.108  0.9863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H - M     -10.000 5.16 48  -1.939  0.1077</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P value adjustment: dunnettx method for 2 tests </span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">## Same when enhanced labeling is used:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="contrast.html">contrast</a></span><span class="op">(</span><span class="va">warp.emm</span>, <span class="st">"trt.vs.ctrl"</span>, </span></span>
<span class="r-in"><span>         enhance.levels <span class="op">=</span> <span class="st">"tension"</span>, ref <span class="op">=</span> <span class="st">"tensionM"</span><span class="op">)</span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Comparisons with grand mean</span></span></span>
<span class="r-in"><span><span class="fu"><a href="contrast.html">contrast</a></span><span class="op">(</span><span class="va">warp.emm</span>, <span class="st">"eff"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = A:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L effect    13.52 2.98 48   4.540  0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  M effect    -7.04 2.98 48  -2.363  0.0333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H effect    -6.48 2.98 48  -2.177  0.0344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = B:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L effect     2.96 2.98 48   0.995  0.3247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  M effect     3.52 2.98 48   1.182  0.3247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H effect    -6.48 2.98 48  -2.177  0.1033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P value adjustment: fdr method for 3 tests </span>
<span class="r-in"><span><span class="co"># Comparisons with a weighted grand mean</span></span></span>
<span class="r-in"><span><span class="fu"><a href="contrast.html">contrast</a></span><span class="op">(</span><span class="va">warp.emm</span>, <span class="st">"eff"</span>, wts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = A:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L effect    16.28 3.61 48   4.509  0.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  M effect    -4.28 2.25 48  -1.903  0.0946</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H effect    -3.72 3.22 48  -1.156  0.2535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = B:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L effect     2.56 3.61 48   0.708  0.4824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  M effect     3.11 2.25 48   1.384  0.2592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  H effect    -6.89 3.22 48  -2.139  0.1127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P value adjustment: fdr method for 3 tests </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare only low and high tensions</span></span></span>
<span class="r-in"><span><span class="co"># Note pairs(emm, ...) calls contrast(emm, "pairwise", ...)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">warp.emm</span>, exclude <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = A:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L - H       20.00 5.16 48   3.878  0.0003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wool = B:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  contrast estimate   SE df t.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  L - H        9.44 5.16 48   1.831  0.0733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># (same results using exclude = "M" or include = c("L","H") or include = c(1,3))</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Setting up a custom contrast function</span></span></span>
<span class="r-in"><span><span class="va">helmert.emmc</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">levs</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">M</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/contrast.html" class="external-link">contr.helmert</a></span><span class="op">(</span><span class="va">levs</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">M</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">levs</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="st">"vs earlier"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">M</span>, <span class="st">"desc"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Helmert contrasts"</span></span></span>
<span class="r-in"><span>    <span class="va">M</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="contrast.html">contrast</a></span><span class="op">(</span><span class="va">warp.emm</span>, <span class="st">"helmert"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in contrast.emmGrid(warp.emm, "helmert"):</span> Contrast function 'helmert.emmc' not found</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># See what is used for polynomial contrasts with 6 levels</span></span></span>
<span class="r-in"><span><span class="fu">emmeans</span><span class="fu">:::</span><span class="fu">poly.emmc</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell V. Lenth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

