<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Confidence intervals and tests in emmeans • emmeans</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Confidence intervals and tests in emmeans">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">emmeans</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.10.4.900001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/AQuickStart.html">Quick start guide for **emmeans**</a></li>
    <li><a class="dropdown-item" href="../articles/basics.html">Basics of estimated marginal means</a></li>
    <li><a class="dropdown-item" href="../articles/comparisons.html">Comparisons and contrasts in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/confidence-intervals.html">Confidence intervals and tests in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/FAQs.html">FAQs for emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/interactions.html">Interaction analysis in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/messy-data.html">Working with messy data</a></li>
    <li><a class="dropdown-item" href="../articles/models.html">Models supported by emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/predictions.html">Prediction in **emmeans**</a></li>
    <li><a class="dropdown-item" href="../articles/re-engineering-clds.html">Re-engineering CLDs</a></li>
    <li><a class="dropdown-item" href="../articles/sophisticated.html">Sophisticated models in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/transformations.html">Transformations and link functions in emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/utilities.html">Utilities and options for emmeans</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-topics.html">Index of vignette topics</a></li>
    <li><a class="dropdown-item" href="../articles/xplanations.html">Explanations supplement</a></li>
    <li><a class="dropdown-item" href="../articles/xtending.html">For developers: Extending **emmeans**</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rvlenth/emmeans/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Confidence intervals and tests in emmeans</h1>
                        <h4 data-toc-skip class="author">emmeans
package, Version 1.10.4.900001</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rvlenth/emmeans/blob/master/vignettes/confidence-intervals.Rmd" class="external-link"><code>vignettes/confidence-intervals.Rmd</code></a></small>
      <div class="d-none name"><code>confidence-intervals.Rmd</code></div>
    </div>

    
    
<!-- @index Vignettes!Confidence intervals and tests -->
<div class="section level2">
<h2 id="contents">Contents<a class="anchor" aria-label="anchor" href="#contents"></a>
</h2>
<p>This vignette describes various ways of summarizing
<code>emmGrid</code> objects.</p>
<ol style="list-style-type: decimal">
<li><a href="#summary"><code>summary()</code>, <code>confint()</code>,
and <code>test()</code></a></li>
<li>
<a href="#tran">Back-transforming to response scale</a> (See also
the <a href="transformations.html">“transformations” vignette</a>)</li>
<li><a href="#adjust">Multiplicity adjustments</a></li>
<li><a href="#byvars">Using “by” variables</a></li>
<li><a href="#joint">Joint (omnibus) tests</a></li>
<li><a href="#equiv">Testing equivalence, noninferiority,
nonsuperiority</a></li>
<li>Graphics (in <a href="basics.html#plots">“basics” vignette</a>)</li>
</ol>
<p><a href="vignette-topics.html">Index of all vignette topics</a></p>
</div>
<div class="section level2">
<h2 id="summary">
<code>summary()</code>, <code>confint()</code>, and
<code>test()</code><a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<!-- @index `summary()`; `summary()`!`infer`; `confint()`; `test()`; 
    Confidence intervals; `summary()`!Calculated columns; 
    `summary()`!Show sample size; Sample size, displaying;
            Tests!One- and two-sided; Tests!Nonzero null;
            `summary()`!Bayesian models; `summary()`!`hpd.summary()`;
            Examples!`pigs` -->
<p>The most important method for <code>emmGrid</code> objects is
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>. For one thing, it is called by default when you
display an <code><a href="../reference/emmeans.html">emmeans()</a></code> result. The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>
function has a lot of options, and the detailed documentation via
<code><a href="../reference/summary.emmGrid.html">help("summary.emmGrid")</a></code> is worth a look.</p>
<p>For ongoing illustrations, let’s re-create some of the objects in the
<a href="basics.html">“basics” vignette</a> for the <code>pigs</code>
example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="../reference/make.tran.html">inverse</a></span><span class="op">(</span><span class="va">conc</span><span class="op">)</span> <span class="op">~</span> <span class="va">source</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">percent</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">pigs</span><span class="op">)</span></span>
<span><span class="va">RG</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ref_grid.html">ref_grid</a></span><span class="op">(</span><span class="va">mod4</span><span class="op">)</span></span>
<span><span class="va">EMM.source</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">RG</span>, <span class="st">"source"</span><span class="op">)</span></span></code></pre></div>
<p>Just <code>summary(&lt;object&gt;)</code> by itself will produce a
summary that varies somewhat according to context. It does this by
setting different defaults for the <code>infer</code> argument, which
consists of two logical values, specifying confidence intervals and
tests, respectively. [The exception is models fitted using MCMC methods,
where <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> is diverted to the
<code><a href="../reference/hpd.summary.html">hpd.summary()</a></code> function, a preferable summary for many
Bayesians.]</p>
<p>The summary of a newly made reference grid will show just estimates
and standard errors, but not confidence intervals or tests (that is,
<code>infer = c(FALSE, FALSE)</code>). The summary of an
<code><a href="../reference/emmeans.html">emmeans()</a></code> result, as we see above, will have intervals, but
no tests (i.e., <code>infer = c(TRUE, FALSE)</code>); and the result of
a <code><a href="../reference/contrast.html">contrast()</a></code> call (see <a href="comparisons.html">comparisons and contrasts</a>) will show test
statistics and <em>P</em> values, but not intervals (i.e.,
<code>infer = c(FALSE, TRUE)</code>). There are courtesy methods
<code><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint()</a></code> and <code><a href="../reference/summary.emmGrid.html">test()</a></code> that just call
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> with the appropriate <code>infer</code> setting;
for example,</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.emmGrid.html">test</a></span><span class="op">(</span><span class="va">EMM.source</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  source emmean       SE df t.ratio p.value</span></span>
<span><span class="co">##  fish   0.0337 0.000926 23  36.380  &lt;.0001</span></span>
<span><span class="co">##  soy    0.0257 0.000945 23  27.141  &lt;.0001</span></span>
<span><span class="co">##  skim   0.0229 0.000994 23  22.989  &lt;.0001</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results are averaged over the levels of: percent </span></span>
<span><span class="co">## Results are given on the inverse (not the response) scale.</span></span></code></pre>
<p>It is not particularly useful, though, to test these EMMs against the
default of zero – which is why tests are not usually shown. It makes a
lot more sense to test them against some target concentration, say 40.
And suppose we want to do a one-sided test to see if the concentration
is greater than 40. Remembering that the response is inverse-transformed
in this model, and that the inverse transformation reverses the
direction of comparisons, so that a <em>right</em>-tailed test on the
<code>conc</code> scale becomes a <em>left</em>-tailed test on the
<code>inverse(conc)</code> scale,</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.emmGrid.html">test</a></span><span class="op">(</span><span class="va">EMM.source</span>, null <span class="op">=</span> <span class="fu"><a href="../reference/make.tran.html">inverse</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span>, side <span class="op">=</span> <span class="st">"&lt;"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  source emmean       SE df  null t.ratio p.value</span></span>
<span><span class="co">##  fish   0.0337 0.000926 23 0.025   9.383  1.0000</span></span>
<span><span class="co">##  soy    0.0257 0.000945 23 0.025   0.697  0.7535</span></span>
<span><span class="co">##  skim   0.0229 0.000994 23 0.025  -2.156  0.0209</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results are averaged over the levels of: percent </span></span>
<span><span class="co">## Results are given on the inverse (not the response) scale. </span></span>
<span><span class="co">## P values are left-tailed</span></span></code></pre>
<p>It is also possible to add calculated columns to the summary, via the
<code>calc</code> argument. The calculations can include any columns up
through <code>df</code> in the summary, as well as any variable in the
object’s <code>grid</code> slot. Among the latter are usually weights in
a column named <code>.wgt.</code>, and we can use that to include sample
size in the summary:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">EMM.source</span>, calc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>n <span class="op">=</span> <span class="op">~</span><span class="va">.wgt.</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  source emmean       SE df  n lower.CL upper.CL</span></span>
<span><span class="co">##  fish   0.0337 0.000926 23 10   0.0318   0.0356</span></span>
<span><span class="co">##  soy    0.0257 0.000945 23 10   0.0237   0.0276</span></span>
<span><span class="co">##  skim   0.0229 0.000994 23  9   0.0208   0.0249</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results are averaged over the levels of: percent </span></span>
<span><span class="co">## Results are given on the inverse (not the response) scale. </span></span>
<span><span class="co">## Confidence level used: 0.95</span></span></code></pre>
<p><a href="#contents">Back to Contents</a></p>
</div>
<div class="section level2">
<h2 id="tran">Back-transforming<a class="anchor" aria-label="anchor" href="#tran"></a>
</h2>
<!-- @index Transformations!Back-transforming; `type`; Response scale -->
<p>Transformations and link functions are supported in several ways in
<strong>emmeans</strong>, making this a complex topic worthy of <a href="transformations.html">its own vignette</a>. Here, we show just the
most basic approach. Namely, specifying the argument
<code>type = "response"</code> will cause the displayed results to be
back-transformed to the response scale, when a transformation or link
function is incorporated in the model. For example, let’s try the
preceding <code><a href="../reference/summary.emmGrid.html">test()</a></code> call again:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.emmGrid.html">test</a></span><span class="op">(</span><span class="va">EMM.source</span>, null <span class="op">=</span> <span class="fu"><a href="../reference/make.tran.html">inverse</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span>, side <span class="op">=</span> <span class="st">"&lt;"</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  source response    SE df null t.ratio p.value</span></span>
<span><span class="co">##  fish       29.7 0.816 23   40   9.383  1.0000</span></span>
<span><span class="co">##  soy        39.0 1.436 23   40   0.697  0.7535</span></span>
<span><span class="co">##  skim       43.8 1.903 23   40  -2.156  0.0209</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results are averaged over the levels of: percent </span></span>
<span><span class="co">## P values are left-tailed </span></span>
<span><span class="co">## Tests are performed on the inverse scale</span></span></code></pre>
<p>Note what changes and what doesn’t change. In the <code><a href="../reference/summary.emmGrid.html">test()</a></code>
call, we <em>still</em> use the 1/40 as the null value;
<code>null</code> must always be specified on the linear-prediction
scale, in this case the inverse. In the output, the displayed estimates,
as well as the <code>null</code> value, are shown back-transformed. As
well, the standard errors are altered (using the delta method). However,
the <em>t</em> ratios and <em>P</em> values are identical to the
preceding results. That is, the tests themselves are still conducted on
the linear-predictor scale (as is noted in the output).</p>
<p>Similar statements apply to confidence intervals on the response
scale:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">EMM.source</span>, side <span class="op">=</span> <span class="st">"&lt;"</span>, level <span class="op">=</span> <span class="fl">.90</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  source response    SE df lower.CL upper.CL</span></span>
<span><span class="co">##  fish       29.7 0.816 23     28.6      Inf</span></span>
<span><span class="co">##  soy        39.0 1.436 23     37.2      Inf</span></span>
<span><span class="co">##  skim       43.8 1.903 23     41.4      Inf</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results are averaged over the levels of: percent </span></span>
<span><span class="co">## Confidence level used: 0.9 </span></span>
<span><span class="co">## Intervals are back-transformed from the inverse scale</span></span></code></pre>
<p>With <code>side = "&lt;"</code>, an <em>upper</em> confidence limit
is computed on the inverse scale, then that limit is back-transformed to
the response scale; and since <code>inverse</code> reverses everything,
those upper confidence limits become lower ones on the response scale.
(We have also illustrated how to change the confidence level.)</p>
<p><a href="#contents">Back to Contents</a></p>
</div>
<div class="section level2">
<h2 id="adjust">Multiplicity adjustments<a class="anchor" aria-label="anchor" href="#adjust"></a>
</h2>
<!-- @index Multiplicity adjustments; `adjust`; 
     Tukey adjustment; Sidak adjustment -->
<p>Both tests and confidence intervals may be adjusted for simultaneous
inference. Such adjustments ensure that the confidence coefficient for a
whole set of intervals is at least the specified level, or to control
for multiplicity in a whole family of tests. This is done via the
<code>adjust</code> argument. For <code><a href="../reference/ref_grid.html">ref_grid()</a></code> and
<code><a href="../reference/emmeans.html">emmeans()</a></code> results, the default is
<code>adjust = "none"</code>. For most <code><a href="../reference/contrast.html">contrast()</a></code> results,
<code>adjust</code> is often something else, depending on what type of
contrasts are created. For example, pairwise comparisons default to
<code>adjust = "tukey"</code>, i.e., the Tukey HSD method. The
<code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> function sometimes <em>changes</em>
<code>adjust</code> if it is inappropriate. For example, with</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">EMM.source</span>, adjust <span class="op">=</span> <span class="st">"tukey"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Note: adjust = "tukey" was changed to "sidak"</span></span>
<span><span class="co">## because "tukey" is only appropriate for one set of pairwise comparisons</span></span></code></pre>
<pre class="ro"><code><span><span class="co">##  source emmean       SE df lower.CL upper.CL</span></span>
<span><span class="co">##  fish   0.0337 0.000926 23   0.0313   0.0361</span></span>
<span><span class="co">##  soy    0.0257 0.000945 23   0.0232   0.0281</span></span>
<span><span class="co">##  skim   0.0229 0.000994 23   0.0203   0.0254</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results are averaged over the levels of: percent </span></span>
<span><span class="co">## Results are given on the inverse (not the response) scale. </span></span>
<span><span class="co">## Confidence level used: 0.95 </span></span>
<span><span class="co">## Conf-level adjustment: sidak method for 3 estimates</span></span></code></pre>
<p>the adjustment is changed to the Sidak method because the Tukey
adjustment is inappropriate unless you are doing pairwise
comparisons.</p>
<div id="adjmore" class="section level7">
<p class="heading"></p>
<!-- @index **mvtnorm** package; Bonferroni adjustment
     Multivariate *t* (`"mvt"`) adjustment; Unadjusted tests -->
<p>An adjustment method that is usually appropriate is Bonferroni;
however, it can be quite conservative. Using <code>adjust = "mvt"</code>
is the closest to being the “exact” all-around method “single-step”
method, as it uses the multivariate <em>t</em> distribution (and the
<strong>mvtnorm</strong> package) with the same covariance structure as
the estimates to determine the adjustment. However, this comes at high
computational expense as the computations are done using simulation
techniques. For a large set of tests (and especially confidence
intervals), the computational lag becomes noticeable if not
intolerable.</p>
<p>For tests, <code>adjust</code> increases the <em>P</em> values over
those otherwise obtained with <code>adjust = "none"</code>. Compare the
following adjusted tests with the unadjusted ones previously
computed.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.emmGrid.html">test</a></span><span class="op">(</span><span class="va">EMM.source</span>, null <span class="op">=</span> <span class="fu"><a href="../reference/make.tran.html">inverse</a></span><span class="op">(</span><span class="fl">40</span><span class="op">)</span>, side <span class="op">=</span> <span class="st">"&lt;"</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  source emmean       SE df  null t.ratio p.value</span></span>
<span><span class="co">##  fish   0.0337 0.000926 23 0.025   9.383  1.0000</span></span>
<span><span class="co">##  soy    0.0257 0.000945 23 0.025   0.697  1.0000</span></span>
<span><span class="co">##  skim   0.0229 0.000994 23 0.025  -2.156  0.0627</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results are averaged over the levels of: percent </span></span>
<span><span class="co">## Results are given on the inverse (not the response) scale. </span></span>
<span><span class="co">## P value adjustment: bonferroni method for 3 tests </span></span>
<span><span class="co">## P values are left-tailed</span></span></code></pre>
<p><a href="#contents">Back to Contents</a></p>
</div>
</div>
<div class="section level2">
<h2 id="byvars">“By” variables<a class="anchor" aria-label="anchor" href="#byvars"></a>
</h2>
<!-- @index `by` groups; Grouping into separate sets -->
<p>Sometimes you want to break a summary down into smaller pieces; for
this purpose, the <code>by</code> argument in <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> is
useful. For example,</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">RG</span>, by <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">## source = fish:</span></span>
<span><span class="co">##  percent prediction      SE df lower.CL upper.CL</span></span>
<span><span class="co">##        9     0.0385 0.00135 23   0.0357   0.0413</span></span>
<span><span class="co">##       12     0.0333 0.00125 23   0.0307   0.0359</span></span>
<span><span class="co">##       15     0.0326 0.00138 23   0.0297   0.0354</span></span>
<span><span class="co">##       18     0.0304 0.00138 23   0.0275   0.0332</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## source = soy:</span></span>
<span><span class="co">##  percent prediction      SE df lower.CL upper.CL</span></span>
<span><span class="co">##        9     0.0305 0.00126 23   0.0279   0.0331</span></span>
<span><span class="co">##       12     0.0253 0.00124 23   0.0227   0.0278</span></span>
<span><span class="co">##       15     0.0245 0.00128 23   0.0219   0.0272</span></span>
<span><span class="co">##       18     0.0223 0.00162 23   0.0190   0.0257</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## source = skim:</span></span>
<span><span class="co">##  percent prediction      SE df lower.CL upper.CL</span></span>
<span><span class="co">##        9     0.0277 0.00127 23   0.0251   0.0303</span></span>
<span><span class="co">##       12     0.0225 0.00125 23   0.0199   0.0250</span></span>
<span><span class="co">##       15     0.0217 0.00139 23   0.0189   0.0246</span></span>
<span><span class="co">##       18     0.0195 0.00163 23   0.0162   0.0229</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results are given on the inverse (not the response) scale. </span></span>
<span><span class="co">## Confidence level used: 0.95</span></span></code></pre>
<p>If there is also an <code>adjust</code> in force when <code>by</code>
variables are used, by default, the adjustment is made
<em>separately</em> on each <code>by</code> group; e.g., in the above,
we would be adjusting for sets of 4 intervals, not all 12 together (but
see “cross-adjustments” below.)</p>
<p>There can be a <code>by</code> specification in
<code><a href="../reference/emmeans.html">emmeans()</a></code> (or equivalently, a <code>|</code> in the
formula); and if so, it is passed on to <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> and used
unless overridden by another <code>by</code>. Here are examples, not
run:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">mod4</span>, <span class="op">~</span> <span class="va">percent</span> <span class="op">|</span> <span class="va">source</span><span class="op">)</span>     <span class="co">### same results as above</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">.Last.value</span>, by <span class="op">=</span> <span class="st">"percent"</span><span class="op">)</span>       <span class="co">### grouped the other way</span></span></code></pre></div>
<p>Specifying <code>by = NULL</code> will remove all grouping.</p>
<div class="section level3">
<h3 id="cross-adjust">Adjustments across <code>by</code> groups<a class="anchor" aria-label="anchor" href="#cross-adjust"></a>
</h3>
<!-- @index cross-group comparisons; `cross.adjust`; `adjust`!vs. `cross.adjust`
     `by` groups!Adjusting across groups; Examples!`warpbreaks` -->
<p>As was mentioned, each <code>by</code> group is regarded as a
separate family with regards to the <code>adjust</code> procedure. For
example, consider a model with interaction for the
<code>warpbreaks</code> data, and construct pairwise comparisons of
<code>tension</code> by <code>wool</code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">warp.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">breaks</span> <span class="op">~</span> <span class="va">wool</span> <span class="op">*</span> <span class="va">tension</span>, data <span class="op">=</span> <span class="va">warpbreaks</span><span class="op">)</span></span>
<span><span class="va">warp.pw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="fu"><a href="../reference/emmeans.html">emmeans</a></span><span class="op">(</span><span class="va">warp.lm</span>, <span class="op">~</span> <span class="va">tension</span> <span class="op">|</span> <span class="va">wool</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">warp.pw</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">## wool = A:</span></span>
<span><span class="co">##  contrast estimate   SE df t.ratio p.value</span></span>
<span><span class="co">##  L - M      20.556 5.16 48   3.986  0.0007</span></span>
<span><span class="co">##  L - H      20.000 5.16 48   3.878  0.0009</span></span>
<span><span class="co">##  M - H      -0.556 5.16 48  -0.108  0.9936</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## wool = B:</span></span>
<span><span class="co">##  contrast estimate   SE df t.ratio p.value</span></span>
<span><span class="co">##  L - M      -0.556 5.16 48  -0.108  0.9936</span></span>
<span><span class="co">##  L - H       9.444 5.16 48   1.831  0.1704</span></span>
<span><span class="co">##  M - H      10.000 5.16 48   1.939  0.1389</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## P value adjustment: tukey method for comparing a family of 3 estimates</span></span></code></pre>
<p>We have two sets of 3 comparisons, and the (default) Tukey adjustment
is made <em>separately</em> in each group.</p>
<p>However, sometimes we want the multiplicity adjustment to be broader.
This broadening can be done in two ways. One is to remove the
<code>by</code> variable, which then treats all results as one family.
In our example:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.emmGrid.html">test</a></span><span class="op">(</span><span class="va">warp.pw</span>, by <span class="op">=</span> <span class="cn">NULL</span>, adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  contrast wool estimate   SE df t.ratio p.value</span></span>
<span><span class="co">##  L - M    A      20.556 5.16 48   3.986  0.0014</span></span>
<span><span class="co">##  L - H    A      20.000 5.16 48   3.878  0.0019</span></span>
<span><span class="co">##  M - H    A      -0.556 5.16 48  -0.108  1.0000</span></span>
<span><span class="co">##  L - M    B      -0.556 5.16 48  -0.108  1.0000</span></span>
<span><span class="co">##  L - H    B       9.444 5.16 48   1.831  0.4396</span></span>
<span><span class="co">##  M - H    B      10.000 5.16 48   1.939  0.3504</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## P value adjustment: bonferroni method for 6 tests</span></span></code></pre>
<p>This accomplishes the goal of putting all the comparisons in one
family of 6 comparisons. Note that the Tukey adjustment may not be used
here because we no longer have <em>one</em> set of pairwise
comparisons.</p>
<p>An alternative is to specify <code>cross.adjust</code>, which
specifies an additional adjustment method to apply to corresponding sets
of within-group adjusted <em>P</em> values:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.emmGrid.html">test</a></span><span class="op">(</span><span class="va">warp.pw</span>, adjust <span class="op">=</span> <span class="st">"tukey"</span>, cross.adjust <span class="op">=</span> <span class="st">"bonferroni"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">## wool = A:</span></span>
<span><span class="co">##  contrast estimate   SE df t.ratio p.value</span></span>
<span><span class="co">##  L - M      20.556 5.16 48   3.986  0.0013</span></span>
<span><span class="co">##  L - H      20.000 5.16 48   3.878  0.0018</span></span>
<span><span class="co">##  M - H      -0.556 5.16 48  -0.108  1.0000</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## wool = B:</span></span>
<span><span class="co">##  contrast estimate   SE df t.ratio p.value</span></span>
<span><span class="co">##  L - M      -0.556 5.16 48  -0.108  1.0000</span></span>
<span><span class="co">##  L - H       9.444 5.16 48   1.831  0.3407</span></span>
<span><span class="co">##  M - H      10.000 5.16 48   1.939  0.2777</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## P value adjustment: tukey method for comparing a family of 3 estimates </span></span>
<span><span class="co">## Cross-group P-value adjustment: bonferroni</span></span></code></pre>
<p>These adjustments are less conservative than the previous result, but
it is still a conservative adjustment to the set of 6 tests. Had we also
specified <code>adjust = "bonferroni"</code>, we would have obtained the
same adjusted <em>P</em> values as we obtained with
<code>by = NULL</code>.</p>
</div>
<div class="section level3">
<h3 id="simple">Simple comparisons<a class="anchor" aria-label="anchor" href="#simple"></a>
</h3>
<!-- @index Simple comparisons; `contrast()`!`simple`; `simple = "each"` -->
<p>There is also a <code>simple</code> argument for
<code><a href="../reference/contrast.html">contrast()</a></code> that is in essence the inverse of
<code>by</code>; the contrasts are run using everything <em>except</em>
the specified variables as <code>by</code> variables. To illustrate,
let’s consider the model for <code>pigs</code> that includes the
interaction (so that the levels of one factor compare differently at
levels of the other factor).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod5</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="../reference/make.tran.html">inverse</a></span><span class="op">(</span><span class="va">conc</span><span class="op">)</span> <span class="op">~</span> <span class="va">source</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">percent</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">pigs</span><span class="op">)</span></span>
<span><span class="va">RG5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ref_grid.html">ref_grid</a></span><span class="op">(</span><span class="va">mod5</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/contrast.html">contrast</a></span><span class="op">(</span><span class="va">RG5</span>, <span class="st">"consec"</span>, simple <span class="op">=</span> <span class="st">"percent"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">## source = fish:</span></span>
<span><span class="co">##  contrast               estimate      SE df t.ratio p.value</span></span>
<span><span class="co">##  percent12 - percent9  -6.64e-03 0.00285 17  -2.328  0.0833</span></span>
<span><span class="co">##  percent15 - percent12 -6.68e-05 0.00285 17  -0.023  1.0000</span></span>
<span><span class="co">##  percent18 - percent15 -1.40e-03 0.00285 17  -0.489  0.9283</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## source = soy:</span></span>
<span><span class="co">##  contrast               estimate      SE df t.ratio p.value</span></span>
<span><span class="co">##  percent12 - percent9  -4.01e-03 0.00255 17  -1.572  0.3168</span></span>
<span><span class="co">##  percent15 - percent12  2.61e-04 0.00255 17   0.102  0.9993</span></span>
<span><span class="co">##  percent18 - percent15 -2.18e-03 0.00361 17  -0.605  0.8872</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## source = skim:</span></span>
<span><span class="co">##  contrast               estimate      SE df t.ratio p.value</span></span>
<span><span class="co">##  percent12 - percent9  -5.26e-03 0.00255 17  -2.061  0.1401</span></span>
<span><span class="co">##  percent15 - percent12 -2.86e-03 0.00285 17  -1.001  0.6526</span></span>
<span><span class="co">##  percent18 - percent15 -3.76e-03 0.00383 17  -0.982  0.6650</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Note: contrasts are still on the inverse scale. Consider using</span></span>
<span><span class="co">##       regrid() if you want contrasts of back-transformed estimates. </span></span>
<span><span class="co">## P value adjustment: mvt method for 3 tests</span></span></code></pre>
<p>In fact, we may do <em>all</em> one-factor comparisons by specifying
<code>simple = "each"</code>. This typically produces a lot of output,
so use it with care.</p>
<p><a href="#contents">Back to Contents</a></p>
</div>
</div>
<div class="section level2">
<h2 id="joint">Joint tests<a class="anchor" aria-label="anchor" href="#joint"></a>
</h2>
<!-- @index `test()`!`joint = TRUE`; `joint`; Type III tests -->
<p>From the above, we already know how to test individual results. For
pairwise comparisons (details in <a href="comparisons.html">the
“comparisons” vignette</a>), we might do</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">PRS.source</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">EMM.source</span><span class="op">)</span></span>
<span><span class="va">PRS.source</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  contrast    estimate      SE df t.ratio p.value</span></span>
<span><span class="co">##  fish - soy   0.00803 0.00134 23   6.009  &lt;.0001</span></span>
<span><span class="co">##  fish - skim  0.01083 0.00137 23   7.922  &lt;.0001</span></span>
<span><span class="co">##  soy - skim   0.00280 0.00134 23   2.092  0.1136</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results are averaged over the levels of: percent </span></span>
<span><span class="co">## Note: contrasts are still on the inverse scale. Consider using</span></span>
<span><span class="co">##       regrid() if you want contrasts of back-transformed estimates. </span></span>
<span><span class="co">## P value adjustment: tukey method for comparing a family of 3 estimates</span></span></code></pre>
<p>But suppose we want an <em>omnibus</em> test that all these
comparisons are zero. Easy enough, using the <code>joint</code> argument
in <code>test</code> (note: the <code>joint</code> argument is
<em>not</em> available in <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>; only in
<code><a href="../reference/summary.emmGrid.html">test()</a></code>):</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.emmGrid.html">test</a></span><span class="op">(</span><span class="va">PRS.source</span>, joint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  df1 df2 F.ratio p.value note</span></span>
<span><span class="co">##    2  23  34.009  &lt;.0001  d  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## d: df1 reduced due to linear dependence</span></span></code></pre>
<p>Notice that there are three comparisons, but only 2 d.f. for the
test, as cautioned in the message.</p>
<p>The test produced with <code>joint = TRUE</code> is a “type III” test
(assuming the default equal weights are used to obtain the EMMs). See
more on these types of tests for higher-order effects in the <a href="interactions.html#contrasts">“interactions” vignette section on
contrasts</a>.</p>
<div id="joint_tests" class="section level7">
<p class="heading"></p>
<!-- @index `joint_tests()`; Type III tests; Analysis of variance!Type III -->
<p>For convenience, there is also a <code><a href="../reference/joint_tests.html">joint_tests()</a></code> function
that performs joint tests of contrasts among each term in a model or
<code>emmGrid</code> object.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/joint_tests.html">joint_tests</a></span><span class="op">(</span><span class="va">RG5</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  model term     df1 df2 F.ratio p.value</span></span>
<span><span class="co">##  source           2  17  30.309  &lt;.0001</span></span>
<span><span class="co">##  percent          3  17   8.441  0.0012</span></span>
<span><span class="co">##  source:percent   6  17   0.481  0.8135</span></span></code></pre>
<p>The tests of main effects are of families of contrasts; those for
interaction effects are for interaction contrasts. These results are
essentially the same as a “Type-III ANOVA”, but may differ in situations
where there are empty cells or other non-estimability issues, or if
generalizations are present such as unequal weighting. (Another
distinction is that sums of squares and mean squares are not shown; that
is because these really are tests of contrasts among predictions, and
they may or may not correspond to model sums of squares.)</p>
<p>One may use <code>by</code> variables with <code>joint_tests</code>.
For example:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/joint_tests.html">joint_tests</a></span><span class="op">(</span><span class="va">RG5</span>, by <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">## source = fish:</span></span>
<span><span class="co">##  model term df1 df2 F.ratio p.value</span></span>
<span><span class="co">##  percent      3  17   2.967  0.0614</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## source = soy:</span></span>
<span><span class="co">##  model term df1 df2 F.ratio p.value</span></span>
<span><span class="co">##  percent      3  17   1.376  0.2840</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## source = skim:</span></span>
<span><span class="co">##  model term df1 df2 F.ratio p.value</span></span>
<span><span class="co">##  percent      3  17   4.835  0.0130</span></span></code></pre>
<p>In some models, it is possible to specify
<code>submodel = "type2"</code>, thereby obtaining something akin to a
Type II analysis of variance. See the <a href="messy-data.html#type2submodel">messy-data vignette</a> for an
example.</p>
<p><a href="#contents">Back to Contents</a></p>
</div>
</div>
<div class="section level2">
<h2 id="equiv">Testing equivalence, noninferiority, and nonsuperiority<a class="anchor" aria-label="anchor" href="#equiv"></a>
</h2>
<!-- @index Tests!Equivalence; Tests!Noninferiority; `test()`!`delta` -->
<p>The <code>delta</code> argument in <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> or
<code><a href="../reference/summary.emmGrid.html">test()</a></code> allows the user to specify a threshold value to use
in a test of equivalence, noninferiority, or nonsuperiority. An
equivalence test is kind of a backwards significance test, where small
<em>P</em> values are associated with small differences relative to a
specified threshold value <code>delta</code>. The help page for
<code>summary.emmGrid</code> gives the details of these tests. Suppose
in the present example, we consider two sources to be equivalent if they
are within 0.005 of each other. We can test this as follows:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summary.emmGrid.html">test</a></span><span class="op">(</span><span class="va">PRS.source</span>, delta <span class="op">=</span> <span class="fl">0.005</span>, adjust <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  contrast    estimate      SE df t.ratio p.value</span></span>
<span><span class="co">##  fish - soy   0.00803 0.00134 23   2.268  0.9835</span></span>
<span><span class="co">##  fish - skim  0.01083 0.00137 23   4.266  0.9999</span></span>
<span><span class="co">##  soy - skim   0.00280 0.00134 23  -1.641  0.0572</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Results are averaged over the levels of: percent </span></span>
<span><span class="co">## Note: contrasts are still on the inverse scale. Consider using</span></span>
<span><span class="co">##       regrid() if you want contrasts of back-transformed estimates. </span></span>
<span><span class="co">## Statistics are tests of equivalence with a threshold of 0.005 </span></span>
<span><span class="co">## P values are left-tailed</span></span></code></pre>
<p>Using the 0.005 threshold, the <em>P</em> value is quite small for
comparing soy and skim, providing some statistical evidence that their
difference is enough smaller than the threshold to consider them
equivalent.</p>
<p><a href="#contents">Back to Contents</a></p>
</div>
<div class="section level2">
<h2 id="graphics">Graphics<a class="anchor" aria-label="anchor" href="#graphics"></a>
</h2>
<p>Graphical displays of <code>emmGrid</code> objects are described in
the <a href="basics.html#plots">“basics” vignette</a></p>
<p><a href="vignette-topics.html">Index of all vignette topics</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell V. Lenth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
