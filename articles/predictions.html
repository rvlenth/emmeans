<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="emmeans">
<title>Prediction in **emmeans** • emmeans</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prediction in **emmeans**">
<meta property="og:description" content="emmeans">
<meta property="og:image" content="https://rvlenth.github.io/emmeans/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">emmeans</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.10.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/AQuickStart.html">Quick start guide for **emmeans**</a>
    <a class="dropdown-item" href="../articles/basics.html">Basics of estimated marginal means</a>
    <a class="dropdown-item" href="../articles/comparisons.html">Comparisons and contrasts in emmeans</a>
    <a class="dropdown-item" href="../articles/confidence-intervals.html">Confidence intervals and tests in emmeans</a>
    <a class="dropdown-item" href="../articles/FAQs.html">FAQs for emmeans</a>
    <a class="dropdown-item" href="../articles/interactions.html">Interaction analysis in emmeans</a>
    <a class="dropdown-item" href="../articles/messy-data.html">Working with messy data</a>
    <a class="dropdown-item" href="../articles/models.html">Models supported by emmeans</a>
    <a class="dropdown-item" href="../articles/predictions.html">Prediction in **emmeans**</a>
    <a class="dropdown-item" href="../articles/re-engineering-clds.html">Re-engineering CLDs</a>
    <a class="dropdown-item" href="../articles/sophisticated.html">Sophisticated models in emmeans</a>
    <a class="dropdown-item" href="../articles/transformations.html">Transformations and link functions in emmeans</a>
    <a class="dropdown-item" href="../articles/utilities.html">Utilities and options for emmeans</a>
    <a class="dropdown-item" href="../articles/vignette-topics.html">Index of vignette topics</a>
    <a class="dropdown-item" href="../articles/xplanations.html">Explanations supplement</a>
    <a class="dropdown-item" href="../articles/xtending.html">For developers: Extending **emmeans**</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rvlenth/emmeans/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Prediction in **emmeans**</h1>
                        <h4 data-toc-skip class="author">emmeans
package, Version 1.10.2</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rvlenth/emmeans/blob/HEAD/vignettes/predictions.Rmd" class="external-link"><code>vignettes/predictions.Rmd</code></a></small>
      <div class="d-none name"><code>predictions.Rmd</code></div>
    </div>

    
    
<!-- @index Vignettes!Predictions -->
<p>In this vignette, we discuss <strong>emmeans</strong>’s rudimentary
capabilities for constructing prediction intervals.</p>
<div class="section level2">
<h2 id="contents">Contents<a class="anchor" aria-label="anchor" href="#contents"></a>
</h2>
<ol style="list-style-type: decimal">
<li><a href="#ref-grid">Focus on reference grids</a></li>
<li><a href="#sd-estimate">Need for an SD estimate</a></li>
<li><a href="#feedlot">Feedlot example</a></li>
<li><a href="#strata">Predictions on particular strata</a></li>
<li><a href="#bayes">Predictions with Bayesian models</a></li>
</ol>
<p><a href="vignette-topics.html">Index of all vignette topics</a></p>
</div>
<div class="section level2">
<h2 id="ref-grid">Focus on reference grids<a class="anchor" aria-label="anchor" href="#ref-grid"></a>
</h2>
<!-- @index Predictions!Reference grid; Reference grids!Prediction on -->
<p>Prediction is not the central purpose of the <strong>emmeans</strong>
package. Even its name refers to the idea of obtaining marginal averages
of fitted values; and it is a rare situation where one would want to
make a prediction of the average of several observations. We can
certainly do that if it is truly desired, but almost always, predictions
should be based on the reference grid itself (i.e., <em>not</em> the
result of an <code><a href="../reference/emmeans.html">emmeans()</a></code> call), inasmuch as a reference grid
comprises combinations of model predictors.</p>
</div>
<div class="section level2">
<h2 id="sd-estimate">Need for an SD estimate<a class="anchor" aria-label="anchor" href="#sd-estimate"></a>
</h2>
<!-- @index Predictions!Error SD; -->
<p>A prediction interval requires an estimate of the error standard
deviation, because we need to account for both the uncertainty of our
point predictions and the uncertainty of outcomes centered on those
estimates. By its current design, we save the value (if any) returned by
<code>stats::sigma(object)</code> when a reference grid is constructed
for a model <code>object</code>. Not all models provide a
<code><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma()</a></code> method, in which case an error is thrown if the
error SD is not manually specified. Also, in many cases, there may be a
<code><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma()</a></code> method, but it does not return the appropriate
value(s) in the context of the needed predictions. (In an object
returned by <code>lme4::glmer(), for example,</code>sigma()` seems to
always returns 1.0.) Indeed, as will be seen in the example that
follows, one usually needs to construct a manual SD estimate when the
model is a mixed-effects model.</p>
<p>So it is essentially always important to think very specifically
about whether we are using an appropriate value. You may check the value
being assumed by looking at the <code>misc</code> slot in the reference
grid:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ref_grid.html">ref_grid</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="va">rg</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">sigma</span></span></code></pre></div>
<p>Finally, <code>sigma</code> may be a vector, as long as it is
conformable with the estimates in the reference grid. This would be
appropriate, for example, with a model fitted by
<code><a href="https://rdrr.io/pkg/nlme/man/gls.html" class="external-link">nlme::gls()</a></code> with some kind of non-homogeneous error
structure. It may take some effort, as well as a clear understanding of
the model and its structure, to obtain suitable SD estimates. It was
suggested to me that the function <code><a href="https://easystats.github.io/insight/reference/get_variance.html" class="external-link">insight::get_variance()</a></code>
may be helpful – especially when working with an unfamiliar model class.
Personally, I prefer to make sure I understand the structure of the
model object and/or its summary to ensure I am not going astray.</p>
<p><a href="#contents">Back to Contents</a></p>
</div>
<div class="section level2">
<h2 id="feedlot">Feedlot example<a class="anchor" aria-label="anchor" href="#feedlot"></a>
</h2>
<!-- @index Examples!`feedlot`; Predictions!Total SD; Predictions!graphics -->
<p>To illustrate, consider the <code>feedlot</code> dataset provided
with the package. Here we have several herds of feeder cattle that are
sent to feed lots and given one of three diets. The weights of the
cattle are measured at time of entry (<code>ewt</code>) and at time of
slaughter (<code>swt</code>). Different herds have possibly different
entry weights, based on breed and ranching practices, so we will center
each herd’s <code>ewt</code> measurements, then use that as a covariate
in a mixed model:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feedlot</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">feedlot</span>, adj.ewt <span class="op">=</span> <span class="va">ewt</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ewt</span> <span class="op">~</span> <span class="va">herd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lme4/lme4/" class="external-link">lme4</a></span><span class="op">)</span></span>
<span><span class="va">feedlot.lmer</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lmer</a></span><span class="op">(</span><span class="va">swt</span> <span class="op">~</span> <span class="va">adj.ewt</span> <span class="op">+</span> <span class="va">diet</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">|</span><span class="va">herd</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">feedlot</span><span class="op">)</span></span>
<span><span class="va">feedlot.rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ref_grid.html">ref_grid</a></span><span class="op">(</span><span class="va">feedlot.lmer</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adj.ewt <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">feedlot.rg</span><span class="op">)</span>  <span class="co">## point predictions</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  adj.ewt diet   prediction   SE   df</span></span>
<span><span class="co">##        0 Low          1029 25.5 12.0</span></span>
<span><span class="co">##        0 Medium        998 26.4 13.7</span></span>
<span><span class="co">##        0 High         1031 29.4 19.9</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Degrees-of-freedom method: kenward-roger</span></span></code></pre>
<p>Now, as advised, let’s look at the SDs involved in this model:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">lme4</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nlme/man/VarCorr.html" class="external-link">VarCorr</a></span><span class="op">(</span><span class="va">feedlot.lmer</span><span class="op">)</span>  <span class="co">## for the model</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  Groups   Name        Std.Dev.</span></span>
<span><span class="co">##  herd     (Intercept) 77.087  </span></span>
<span><span class="co">##  Residual             57.832</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feedlot.rg</span><span class="op">@</span><span class="va">misc</span><span class="op">$</span><span class="va">sigma</span>  <span class="co">## default in the ref. grid</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">## [1] 57.83221</span></span></code></pre>
<p>So the residual SD will be assumed in our prediction intervals if we
don’t specify something else. And we <em>do</em> want something else,
because in order to predict the slaughter weight of an arbitrary animal,
without regard to its herd, we need to account for the variation among
herds too, which is seen to be considerable. The two SDs reported by
<code><a href="https://rdrr.io/pkg/nlme/man/VarCorr.html" class="external-link">VarCorr()</a></code> are assumed to represent independent sources of
variation, so they may be combined into a total SD using the Pythagorean
Theorem. We will update the reference grid with the new value:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feedlot.rg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">feedlot.rg</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">77.087</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">57.832</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We are now ready to form prediction intervals. To do so, simply call
the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function with an <code>interval</code>
argument:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">feedlot.rg</span>, interval <span class="op">=</span> <span class="st">"prediction"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">##  adj.ewt diet   prediction    SE   df lower.PL upper.PL</span></span>
<span><span class="co">##        0 Low          1029  99.7 12.0      812     1247</span></span>
<span><span class="co">##        0 Medium        998  99.9 13.7      783     1213</span></span>
<span><span class="co">##        0 High         1031 100.7 19.9      821     1241</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Degrees-of-freedom method: kenward-roger </span></span>
<span><span class="co">## Prediction intervals and SEs are based on an error SD of 96.369 </span></span>
<span><span class="co">## Confidence level used: 0.95</span></span></code></pre>
<p>These results may also be displayed graphically:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">feedlot.rg</span>, PIs <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="predictions_files/figure-html/unnamed-chunk-7-1.png" alt="Side-by-side CIs and PIs. The PIs are much wider, and have the endpoints found in the preceding predit() call" width="432"></p>
<p>The inner intervals are confidence intervals, and the outer ones are
the prediction intervals.</p>
<p>Note that the SEs for prediction are considerably greater than the
SEs for estimation in the original summary of <code>feedlot.rg</code>.
Also, as a sanity check, observe that these prediction intervals cover
about the same ground as the original data:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">feedlot</span><span class="op">$</span><span class="va">swt</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">## [1]  816 1248</span></span></code></pre>
<p>By the way, we could have specified the desired <code>sigma</code>
value as an additional <code>sigma</code> argument in the
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> call, rather than updating the
<code>feedlot.rg</code> object.</p>
<p><a href="#contents">Back to Contents</a></p>
</div>
<div class="section level2">
<h2 id="strata">Predictions on particular strata<a class="anchor" aria-label="anchor" href="#strata"></a>
</h2>
<!-- @index Predictions!on Particular strata -->
<p>Suppose, in our example, we want to predict <code>swt</code> for one
or more particular herds. Then the total SD we computed is not
appropriate for that purpose, because that includes variation among
herds.</p>
<p>But more to the point, if we are talking about particular herds, then
we are really regarding <code>herd</code> as a fixed effect of interest;
so the expedient thing to do is to fit a different model where
<code>herd</code> is a fixed effect:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">feedlot.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">swt</span> <span class="op">~</span> <span class="va">adj.ewt</span> <span class="op">+</span> <span class="va">diet</span> <span class="op">+</span> <span class="va">herd</span>, data <span class="op">=</span> <span class="va">feedlot</span><span class="op">)</span></span></code></pre></div>
<p>So to predict slaughter weight for herds <code>9</code> and
<code>19</code>:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">newrg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ref_grid.html">ref_grid</a></span><span class="op">(</span><span class="va">feedlot.lm</span>, at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adj.ewt <span class="op">=</span> <span class="fl">0</span>, herd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"9"</span>, <span class="st">"19"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">newrg</span>, interval <span class="op">=</span> <span class="st">"prediction"</span>, by <span class="op">=</span> <span class="st">"herd"</span><span class="op">)</span></span></code></pre></div>
<pre class="ro"><code><span><span class="co">## herd = 9:</span></span>
<span><span class="co">##  adj.ewt diet   prediction   SE df lower.PL upper.PL</span></span>
<span><span class="co">##        0 Low           867 63.6 53      740      995</span></span>
<span><span class="co">##        0 Medium        835 64.1 53      707      964</span></span>
<span><span class="co">##        0 High          866 66.3 53      733      999</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## herd = 19:</span></span>
<span><span class="co">##  adj.ewt diet   prediction   SE df lower.PL upper.PL</span></span>
<span><span class="co">##        0 Low          1069 62.1 53      945     1194</span></span>
<span><span class="co">##        0 Medium       1037 62.8 53      911     1163</span></span>
<span><span class="co">##        0 High         1068 64.0 53      940     1197</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Prediction intervals and SEs are based on an error SD of 57.782 </span></span>
<span><span class="co">## Confidence level used: 0.95</span></span></code></pre>
<p>This is an instance where the default <code>sigma</code> was already
correct (being the only error SD we have available). The SD value is
comparable to the residual SD in the previous model, and the prediction
SEs are smaller than those for predicting over all herds.</p>
<p><a href="#contents">Back to Contents</a></p>
</div>
<div class="section level2">
<h2 id="bayes">Predictions with Bayesian models<a class="anchor" aria-label="anchor" href="#bayes"></a>
</h2>
<!-- @index Predictions!Bayesian models -->
<p>For models fitted using Bayesian methods, these kinds of prediction
intervals are available only by forcing a frequentist analysis
(<code>frequentist = TRUE</code>).</p>
<p>However, a better and more flexible approach with Bayesian models is
to simulate observations from the posterior predictive distribution.
This is done via <code><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">as.mcmc()</a></code> and specifying a
<code>likelihood</code> argument. An example is given in the <a href="sophisticated.html#predict-mcmc">“sophisticated models”
vignette</a>.</p>
<p><a href="#contents">Back to Contents</a></p>
<p><a href="vignette-topics.html">Index of all vignette topics</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell V. Lenth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
