<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function produces an analysis-of-variance-like table based on linear
functions of predictors in a model or emmGrid object. Specifically,
the function constructs, for each combination of factors (or covariates
reduced to two or more levels), a set of (interaction) contrasts via
contrast, and then tests them using test with
joint = TRUE. Optionally, one or more of the predictors may be used as
by variable(s), so that separate tables of tests are produced for
each combination of them."><title>Compute joint tests of the terms in a model — joint_tests • emmeans</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute joint tests of the terms in a model — joint_tests"><meta property="og:description" content="This function produces an analysis-of-variance-like table based on linear
functions of predictors in a model or emmGrid object. Specifically,
the function constructs, for each combination of factors (or covariates
reduced to two or more levels), a set of (interaction) contrasts via
contrast, and then tests them using test with
joint = TRUE. Optionally, one or more of the predictors may be used as
by variable(s), so that separate tables of tests are produced for
each combination of them."><meta property="og:image" content="https://rvlenth.github.io/emmeans/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">emmeans</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.10.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/AQuickStart.html">Quick start guide for **emmeans**</a>
    <a class="dropdown-item" href="../articles/basics.html">Basics of estimated marginal means</a>
    <a class="dropdown-item" href="../articles/comparisons.html">Comparisons and contrasts in emmeans</a>
    <a class="dropdown-item" href="../articles/confidence-intervals.html">Confidence intervals and tests in emmeans</a>
    <a class="dropdown-item" href="../articles/FAQs.html">FAQs for emmeans</a>
    <a class="dropdown-item" href="../articles/interactions.html">Interaction analysis in emmeans</a>
    <a class="dropdown-item" href="../articles/messy-data.html">Working with messy data</a>
    <a class="dropdown-item" href="../articles/models.html">Models supported by emmeans</a>
    <a class="dropdown-item" href="../articles/predictions.html">Prediction in **emmeans**</a>
    <a class="dropdown-item" href="../articles/re-engineering-clds.html">Re-engineering CLDs</a>
    <a class="dropdown-item" href="../articles/sophisticated.html">Sophisticated models in emmeans</a>
    <a class="dropdown-item" href="../articles/transformations.html">Transformations and link functions in emmeans</a>
    <a class="dropdown-item" href="../articles/utilities.html">Utilities and options for emmeans</a>
    <a class="dropdown-item" href="../articles/vignette-topics.html">Index of vignette topics</a>
    <a class="dropdown-item" href="../articles/xplanations.html">Explanations supplement</a>
    <a class="dropdown-item" href="../articles/xtending.html">For developers: Extending **emmeans**</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rvlenth/emmeans/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute joint tests of the terms in a model</h1>
      <small class="dont-index">Source: <a href="https://github.com/rvlenth/emmeans/blob/HEAD/R/test.R" class="external-link"><code>R/test.R</code></a></small>
      <div class="d-none name"><code>joint_tests.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function produces an analysis-of-variance-like table based on linear
functions of predictors in a model or <code>emmGrid</code> object. Specifically,
the function constructs, for each combination of factors (or covariates
reduced to two or more levels), a set of (interaction) contrasts via
<code><a href="contrast.html">contrast</a></code>, and then tests them using <code><a href="summary.emmGrid.html">test</a></code> with
<code>joint = TRUE</code>. Optionally, one or more of the predictors may be used as
<code>by</code> variable(s), so that separate tables of tests are produced for
each combination of them.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">joint_tests</span><span class="op">(</span><span class="va">object</span>, by <span class="op">=</span> <span class="cn">NULL</span>, show0df <span class="op">=</span> <span class="cn">FALSE</span>, showconf <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cov.reduce <span class="op">=</span> <span class="fu">make.meanint</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">make.meanint</span><span class="op">(</span><span class="va">delta</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">meanint</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">make.symmint</span><span class="op">(</span><span class="va">ctr</span>, <span class="va">delta</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">symmint</span><span class="op">(</span><span class="va">ctr</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>a fitted model, <code>emmGrid</code>, or <code>emm_list</code>. If the
latter, its first element is used.</p></dd>


<dt>by</dt>
<dd><p>character names of <code>by</code> variables. Separate sets of tests are
run for each combination of these.</p></dd>


<dt>show0df</dt>
<dd><p>logical value; if <code>TRUE</code>, results with zero numerator
degrees of freedom are displayed, if <code>FALSE</code> they are skipped</p></dd>


<dt>showconf</dt>
<dd><p>logical value.
When we have models with estimability issues (e.g., missing cells), then with
<code>showconf = TRUE</code>, we test any remaining effects that are not purely
due to contrasts of a single term. If found, they are labeled
<code>(confounded)</code>. See
<code><a href="../articles/xplanations.html">vignette("xplanations")</a></code> for more information.</p></dd>


<dt>cov.reduce</dt>
<dd><p>a function.
If <code>object</code> is a fitted model, it is
replaced by <code>ref_grid(object, cov.reduce = cov.reduce, ...)</code>.
For this purpose, the functions <code>meanint</code> and <code>symmint</code> are
available for returning an interval around the mean or around zero,
respectively. Se the section below on covariates.</p></dd>


<dt>...</dt>
<dd><p>additional arguments passed to <code>ref_grid</code> and <code>emmeans</code></p></dd>


<dt>delta, ctr</dt>
<dd><p>arguments for <code>make.meanint</code> and <code>make.symmint</code></p></dd>


<dt>x</dt>
<dd><p>argument for <code>meanint</code> and <code>symmint</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a <code>summary_emm</code> object (same as is produced by</p>
<p></p>
<p><code><a href="summary.emmGrid.html">summary.emmGrid</a></code>). All effects for which there are no
  estimable contrasts are omitted from the results. 
  There may be an additional row named <code>(confounded)</code> which accounts
  for additional degrees of freedom for effects not accounted for in the 
  preceding rows.</p>
  

<p>The returned object also includes an <code>"est.fcns"</code> attribute, which is a
  named list containing the linear functions associated with each joint test. 
  No estimable functions are included for confounded effects.</p>


<p><code>make.meanint</code> returns the function 
<code>function(x) mean(x) + delta * c(-1, 1)</code>,
  and <code>make.symmint(ctr, delta)</code> returns the function
<code>function(x) ctr + delta * c(-1, 1)</code></p>


<p>(which does not depend on <code>x</code>).
        The cases with <code>delta = 1</code>, <code>meanint = make.meanint(1)</code></p>
 

<p>and <code>symmint(ctr) = make.symmint(ctr, 1)</code></p>


<p>are retained for back-compatibility reasons.
        These functions are available primarily for use with <code>cov.reduce</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In models with only factors, no covariates, these tests correspond to
“type III” tests a la <span class="pkg">SAS</span>, as long as equal-weighted averaging
is used and there are no estimability issues. When covariates are present and
they interact with factors, the results depend on how the covariate is
handled in constructing the reference grid. See the section on covariates
below. The point that one must always remember is that <code>joint_tests</code>
always tests contrasts among EMMs, in the context of the reference grid,
whereas type III tests are tests of model coefficients -- which may or may
not have anything to do with EMMs or contrasts.</p>
    </div>
    <div class="section level2">
    <h2 id="dealing-with-covariates">Dealing with covariates<a class="anchor" aria-label="anchor" href="#dealing-with-covariates"></a></h2>
    

<p>A covariate (or any other predictor) must have <em>more than one value in 
the reference grid</em> in order to test its effect and be included in the results.
Therefore, when <code>object</code> is a model, we default to <code>cov.reduce = meanint</code>
which sets each covariate at a symmetric interval about its mean. But
when <code>object</code> is an existing reference grid, it often has only one value 
for covariates, in which case they are excluded from the joint tests.</p>
<p>Covariates present further complications in that their values in the
reference grid can affect the joint tests of <em>other</em> effects. When
covariates are centered around their means (the default), then the tests we
obtain can be described as joint tests of covariate-adjusted means; and that
is our intended use here. However, some software such as <span class="pkg">SAS</span> and
<code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova</a></code> adopt the convention of centering covariates around zero;
and for that purpose, one can use <code>cov.reduce = symmint(0)</code> when calling
with a model object (or in constructing a reference grid). However, adjusted
means with covariates set at or around zero do not make much sense in the
context of interpreting estimated marginal means, unless the covariate means
really are zero.</p>
<p>See the examples below with the <code>toy</code> dataset.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="summary.emmGrid.html">test</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">pigs.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">conc</span><span class="op">)</span> <span class="op">~</span> <span class="va">source</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">percent</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">pigs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">jt</span> <span class="op">&lt;-</span> <span class="fu">joint_tests</span><span class="op">(</span><span class="va">pigs.lm</span><span class="op">)</span><span class="op">)</span>             <span class="co">## will be same as type III ANOVA</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term     df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  source           2  17  30.256  &lt;.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  percent          3  17   8.214  0.0013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  source:percent   6  17   0.926  0.5011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Estimable functions associated with "percent"</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">jt</span>, <span class="st">"est.fcns"</span><span class="op">)</span> <span class="op">$</span> <span class="st">"percent"</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      (Intercept) sourcesoy sourceskim factor(percent)12 factor(percent)15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]           0         0          0         -0.904534          0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]           0         0          0          0.000000         -0.904534</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]           0         0          0          0.000000          0.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      factor(percent)18 sourcesoy:factor(percent)12 sourceskim:factor(percent)12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]          0.000000                  -0.3015113                   -0.3015113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]          0.000000                   0.0000000                    0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]         -0.904534                   0.0000000                    0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      sourcesoy:factor(percent)15 sourceskim:factor(percent)15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]                   0.0000000                    0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]                  -0.3015113                   -0.3015113</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]                   0.0000000                    0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      sourcesoy:factor(percent)18 sourceskim:factor(percent)18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]                   0.0000000                    0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]                   0.0000000                    0.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]                  -0.3015113                   -0.3015113</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">joint_tests</span><span class="op">(</span><span class="va">pigs.lm</span>, weights <span class="op">=</span> <span class="st">"outer"</span><span class="op">)</span>  <span class="co">## differently weighted</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term     df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  source           2  17  28.601  &lt;.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  percent          3  17   7.889  0.0016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  source:percent   6  17   0.926  0.5011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">joint_tests</span><span class="op">(</span><span class="va">pigs.lm</span>, by <span class="op">=</span> <span class="st">"source"</span><span class="op">)</span>      <span class="co">## separate joint tests of 'percent'</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> source = fish:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  percent      3  17   1.712  0.2023</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> source = soy:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  percent      3  17   1.290  0.3097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> source = skim:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  percent      3  17   6.676  0.0035</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Comparisons with type III tests in SAS</span></span></span>
<span class="r-in"><span><span class="va">toy</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    treat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    female <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>,   <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span> <span class="op">)</span>,</span></span>
<span class="r-in"><span>    resp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">17</span>, <span class="fl">12</span>, <span class="fl">14</span>, <span class="fl">19</span>, <span class="fl">28</span>, <span class="fl">26</span>, <span class="fl">26</span>, <span class="fl">34</span>, <span class="fl">33</span>, <span class="fl">27</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">toy.fac</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">resp</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">female</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">toy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">toy.cov</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">resp</span> <span class="op">~</span> <span class="va">treat</span> <span class="op">*</span> <span class="va">female</span>, data <span class="op">=</span> <span class="va">toy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># (These two models have identical fitted values and residuals)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># -- SAS output we'd get with toy.fac --</span></span></span>
<span class="r-in"><span><span class="co">## Source          DF    Type III SS    Mean Square   F Value   Pr &gt; F</span></span></span>
<span class="r-in"><span><span class="co">## treat            1    488.8928571    488.8928571    404.60   &lt;.0001</span></span></span>
<span class="r-in"><span><span class="co">## female           1     78.8928571     78.8928571     65.29   0.0002</span></span></span>
<span class="r-in"><span><span class="co">## treat*female     1      1.7500000      1.7500000      1.45   0.2741</span></span></span>
<span class="r-in"><span><span class="co"># </span></span></span>
<span class="r-in"><span><span class="co"># -- SAS output we'd get with toy.cov --</span></span></span>
<span class="r-in"><span><span class="co">## Source          DF    Type III SS    Mean Square   F Value   Pr &gt; F</span></span></span>
<span class="r-in"><span><span class="co">## treat            1    252.0833333    252.0833333    208.62   &lt;.0001</span></span></span>
<span class="r-in"><span><span class="co">## female           1     78.8928571     78.8928571     65.29   0.0002</span></span></span>
<span class="r-in"><span><span class="co">## female*treat     1      1.7500000      1.7500000      1.45   0.2741</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">joint_tests</span><span class="op">(</span><span class="va">toy.fac</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term   df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treat          1   6 404.601  &lt;.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  female         1   6  65.291  0.0002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treat:female   1   6   1.448  0.2741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">joint_tests</span><span class="op">(</span><span class="va">toy.cov</span><span class="op">)</span>   <span class="co"># female is regarded as a 2-level factor by default</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term   df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treat          1   6 404.601  &lt;.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  female         1   6  65.291  0.0002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treat:female   1   6   1.448  0.2741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Treat 'female' as a numeric covariate (via cov.keep = 0)</span></span></span>
<span class="r-in"><span><span class="co">## ... then tests depend on where we center things</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Center around the mean</span></span></span>
<span class="r-in"><span><span class="fu">joint_tests</span><span class="op">(</span><span class="va">toy.cov</span>, cov.keep <span class="op">=</span> <span class="fl">0</span>, cov.reduce <span class="op">=</span> <span class="fu">make.meanint</span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term   df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treat          1   6 401.865  &lt;.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  female         1   6  65.291  0.0002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treat:female   1   6   1.448  0.2741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Center around zero (like SAS's results for toy.cov)</span></span></span>
<span class="r-in"><span><span class="fu">joint_tests</span><span class="op">(</span><span class="va">toy.cov</span>, cov.keep <span class="op">=</span> <span class="fl">0</span>, cov.reduce <span class="op">=</span> <span class="fu">make.symmint</span><span class="op">(</span>ctr <span class="op">=</span> <span class="fl">0</span>, delta <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term   df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treat          1   6 208.621  &lt;.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  female         1   6  65.291  0.0002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treat:female   1   6   1.448  0.2741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># Center around 0.5 (like SAS's results for toy.fac)</span></span></span>
<span class="r-in"><span><span class="fu">joint_tests</span><span class="op">(</span><span class="va">toy.cov</span>, cov.keep <span class="op">=</span> <span class="fl">0</span>, cov.reduce <span class="op">=</span> <span class="va">range</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term   df1 df2 F.ratio p.value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treat          1   6 404.601  &lt;.0001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  female         1   6  65.291  0.0002</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  treat:female   1   6   1.448  0.2741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example with empty cells and confounded effects</span></span></span>
<span class="r-in"><span><span class="va">low3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">ubds</span>, <span class="st">"cells"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">ubds.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">A</span><span class="op">*</span><span class="va">B</span><span class="op">*</span><span class="va">C</span>, data <span class="op">=</span> <span class="va">ubds</span>, subset <span class="op">=</span> <span class="op">-</span><span class="va">low3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show overall joint tests by C:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="ref_grid.html">ref_grid</a></span><span class="op">(</span><span class="va">ubds.lm</span>, by <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="contrast.html">contrast</a></span><span class="op">(</span><span class="st">"consec"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="summary.emmGrid.html">test</a></span><span class="op">(</span>joint <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  C df1 df2 F.ratio p.value note</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1   6  71   8.993  &lt;.0001    e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2   7  71   9.763  &lt;.0001    e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3   8  71   8.774  &lt;.0001     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e: df1 reduced due to non-estimability </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Break each of the above into smaller components:</span></span></span>
<span class="r-in"><span><span class="fu">joint_tests</span><span class="op">(</span><span class="va">ubds.lm</span>, by <span class="op">=</span> <span class="st">"C"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C = 1:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term   df1 df2 F.ratio p.value note</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A:B            2  71   5.709  0.0050    e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (confounded)   4  71  10.635  &lt;.0001     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C = 2:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term   df1 df2 F.ratio p.value note</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A              1  71  14.601  0.0003    e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  B              1  71  24.059  &lt;.0001    e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A:B            3  71   2.778  0.0474    e</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (confounded)   2  71   8.656  0.0004     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C = 3:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  model term   df1 df2 F.ratio p.value note</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A              2  71   7.398  0.0012     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  B              2  71  22.157  &lt;.0001     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  A:B            4  71   3.009  0.0237     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> e: df1 reduced due to non-estimability </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Russell V. Lenth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

